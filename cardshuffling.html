<!DOCTYPE html> 
<html> 
<head> <title></title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="cardshuffling.css" /> 
<script type="text/javascript" 
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
<!--l. 8--><p class="noindent" >Steven R. Dunbar <br 
class="newline" />Department of Mathematics <br 
class="newline" />203 Avery Hall <br 
class="newline" />University of Nebraska-Lincoln <br 
class="newline" />Lincoln, NE 68588-0130 <br 
class="newline" /><span 
class="cmtt-12">http://www.math.unl.edu </span><br 
class="newline" />Voice: 402-472-3731 <br 
class="newline" />Fax: 402-472-8466                  </p>
<div class="center" 
>
<!--l. 1--><p class="noindent" >
</p><!--l. 6--><p class="noindent" > <span 
class="cmbx-12x-x-144">Topics in</span><br />
<span 
class="cmbx-12x-x-144">Probability Theory and Stochastic Processes</span><br />
<span 
class="cmbx-12x-x-144">Steven R. Dunbar</span>
</p></div>
<!--l. 19--><p class="noindent" >__________________________________________________________________________
</p>
<div class="center" 
>
<!--l. 21--><p class="noindent" >
</p><!--l. 21--><p class="noindent" ><span 
class="cmr-17">Card Shu&#xFB04;ing as a Markov Chain</span></p></div>
<!--l. 23--><p class="indent" >   _______________________________________________________________________
</p><!--l. 15--><p class="indent" >   Note: These pages are prepared with MathJax. MathJax is an open source
JavaScript display engine for mathematics that works in all browsers.
See http://mathjax.org for details on supported browsers, accessibility,
copy-and-paste, and other features.
</p><!--l. 27--><p class="indent" >   _______________________________________________________________________________________________
</p><!--l. 34--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/rating.png" alt="Rating"  
 />
                                                                          

                                                                          
</p>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Rating</h3>
<!--l. 38--><p class="noindent" >Mathematically Mature: may contain mathematics beyond calculus with
proofs.
</p><!--l. 41--><p class="indent" >   _______________________________________________________________________________________________
</p><!--l. 43--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/question_mark.png" alt="Section Starter Question"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-2000"></a>Section Starter Question</h3>
<!--l. 46--><p class="noindent" >Why shu&#xFB04;e a deck of cards? What kind of shu&#xFB04;e do you use? How many shu&#xFB04;es
are su&#xFB03;cient to achieve the purpose of shu&#xFB04;ing?
</p><!--l. 49--><p class="indent" >   _______________________________________________________________________________________________
</p><!--l. 51--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/keyconcepts.png" alt="Key Concepts"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-3000"></a>Key Concepts</h3>
<!--l. 55--><p class="noindent" >
      </p><dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
   1. </dt><dd 
class="enumerate-enumitem">Card deck shu&#xFB04;es are a family of possible re-orderings with probability
      distributions,  leading  to  transition  probabilities,  and  thus  Markov
      processes. The most well-studied type of shu&#xFB04;e is the ri&#xFB04;e shu&#xFB04;e and
      that is the main focus here.
      </dd><dt class="enumerate-enumitem">
   2. </dt><dd 
class="enumerate-enumitem">Going from card order<!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
      to <!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C4;</mi></mrow></math>
      is the same as composing <!--l. 62--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
      with the permutation <!--l. 62--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C4;</mi></mrow></math>.
      Now identify shu&#xFB04;es as functions on <!--l. 63--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="{"  close="}" ><mrow><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mi 
>n</mi></mrow></mfenced></mrow></math>
      to <!--l. 63--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="{"  close="}" ><mrow><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mi 
>n</mi></mrow></mfenced></mrow></math>,
      that is, permutations.Since a particular shu&#xFB04;e is one of a whole family
      of shu&#xFB04;es, chosen with a probability distribution <!--l. 66--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi></mrow></math>
      from the family, the transition probabilities are
                                                                          

                                                                          
<div class="math-display"><!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                 <msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>&#x03C0;</mi><mi 
>&#x03C4;</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C4;</mi><mo 
class="MathClass-rel">&#x2223;</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C0;</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>Q</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C4;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
      <!--l. 71--><p class="nopar" >
      </p></dd><dt class="enumerate-enumitem">
   3. </dt><dd 
class="enumerate-enumitem">The identi&#xFB01;cation of shu&#xFB04;es or operations with permutations gives a
      probability distribution on <!--l. 75--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>.
      </dd><dt class="enumerate-enumitem">
   4. </dt><dd 
class="enumerate-enumitem">A <span 
class="cmbx-12">Top-to-Random Shu&#xFB04;e</span>, takes the top card from a stack of <!--l. 79--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
      cards and inserts it in the gap between the <!--l. 80--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>k</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>th
      card and the <!--l. 80--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>th
      card in the deck.
      </dd><dt class="enumerate-enumitem">
   5. </dt><dd 
class="enumerate-enumitem">The Top-To-Random-Shu&#xFB04;e demonstrates the cut-o&#xFB00; phenomenon for
      the Total Variation distance of the Markov chain distribution from the
      uniform distribution as a function of the number of steps.
      </dd><dt class="enumerate-enumitem">
   6. </dt><dd 
class="enumerate-enumitem">One realistic model of shu&#xFB04;ing a deck of cards is the <span 
class="cmbx-12">ri&#xFB04;e shu&#xFB04;e</span>.
      </dd><dt class="enumerate-enumitem">
   7. </dt><dd 
class="enumerate-enumitem">The set of cuts and interleavings in a ri&#xFB04;e shu&#xFB04;e induces in a natural
      way a density on the set of permutations. Call this a <span 
class="cmbx-12">ri&#xFB04;e shu&#xFB04;e </span>and
      denote it by <!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi></mrow></math>.
      That is, <!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>&#x03C0;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
      is the sum of probabilities of each cut and interleaving that gives the
      rearrangement of the deck corresponding to <!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>.
                                                                          

                                                                          
      </dd><dt class="enumerate-enumitem">
   8. </dt><dd 
class="enumerate-enumitem"><!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
      shu&#xFB04;es the of 3-card deck gets very close to the uniform density, which
      turns out to be the stationary density.
      </dd><dt class="enumerate-enumitem">
   9. </dt><dd 
class="enumerate-enumitem">The probability of achieving a permutation <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
      when doing an <!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e
      is
<div class="math-display"><!--l. 102--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                               <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow>
    <mrow><mi 
>n</mi></mrow></mfrac></mfenced>    <mo 
class="MathClass-punc">,</mo>
</mrow></math></div>
      <!--l. 104--><p class="nopar" > where <!--l. 104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math>
      is the number of rising sequences in <!--l. 104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>.
      </p></dd><dt class="enumerate-enumitem">
  10. </dt><dd 
class="enumerate-enumitem">The eigenvalues of the transition probability matrix for a ri&#xFB04;e shu&#xFB04;e
      are <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>,
      <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mrow></math>,
      <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>4</mn></mrow></mfrac></mrow></math>
      and <!--l. 108--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math>.
      The second largest eigenvalue determines the rate of convergence to the
      stationary distribution. For ri&#xFB04;e shu&#xFB04;ing, this eigenvalue is <!--l. 110--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mrow></math>.
      </dd><dt class="enumerate-enumitem">
  11. </dt><dd 
class="enumerate-enumitem">For a &#xFB01;nite, irreducible, aperiodic Markov chain <!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>Y</mi> </mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>
      distributed as <!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>Q</mi></mrow><mrow 
><mi 
>t</mi></mrow></msup 
></mrow></math>
      at time <!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi></mrow></math>
      and with stationary distribution <!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>,
      and <!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C4;</mi></mrow></math>
                                                                          

                                                                          
      is a strong stationary time, then
<div class="math-display"><!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                         <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>Q</mi></mrow><mrow 
><mi 
>&#x03C4;</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03C0;</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
>
<mi 
>T</mi><mi 
>V</mi> </mrow></msub 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow></mrow></mfenced> <mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mi 
>t</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
      <!--l. 119--><p class="nopar" >
      </p></dd><dt class="enumerate-enumitem">
  12. </dt><dd 
class="enumerate-enumitem">Set <!--l. 121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-bin">+</mo><mn>1</mn>
            </mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
><mi 
>T</mi><mi 
>V</mi> </mrow></msub 
></mrow></math>. Then
      for <!--l. 122--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x1D716;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn></mrow></math>,
           <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
       &#x0028;a&#x0029; </dt><dd 
class="enumerate-enumitem"><!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <msup><mrow 
><mi 
>&#x1D716;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>&#x1D716;</mi></mrow></math>
           for <!--l. 126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
           su&#xFB03;ciently large.
           </dd><dt class="enumerate-enumitem">
      &#x0028;b&#x0029; </dt><dd 
class="enumerate-enumitem"><!--l. 128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>C</mi><msup><mrow 
><mi 
>&#x1D716;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x1D716;</mi></mrow></math>
           for <!--l. 129--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
           su&#xFB03;ciently large.</dd></dl>
      </dd></dl>
<!--l. 133--><p class="noindent" >__________________________________________________________________________
</p><!--l. 135--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/vocabulary.png" alt="Vocabulary"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-4000"></a>Vocabulary</h3>
<!--l. 138--><p class="noindent" >
                                                                          

                                                                          
      </p><dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
   1. </dt><dd 
class="enumerate-enumitem">A defnTop-to-Random Shu&#xFB04;e, takes the top card from a stack of <!--l. 141--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
      cards and inserts it in the gap between the <!--l. 142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>k</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>th
      card and the <!--l. 142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>th
      card in the deck.
      </dd><dt class="enumerate-enumitem">
   2. </dt><dd 
class="enumerate-enumitem">The <span 
class="cmbx-12">total variation distance </span>of <!--l. 145--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi></mrow></math>
      from <!--l. 145--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BD;</mi></mrow></math>
      is
<div class="math-display"><!--l. 148--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
       <mo 
class="MathClass-rel">&#x2225;</mo><mi 
>&#x03BC;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BD;</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
><mi 
>T</mi><mi 
>V</mi> </mrow></msub 
> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mo class="qopname"> max</mo> </mrow><mrow 
><mi 
>A</mi><mo 
class="MathClass-rel">&#x2282;</mo><mi 
>&#x03A9;</mi></mrow></munder 
><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>&#x03BC;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BD;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-rel">&#x007C;</mo> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><munder class="msub"><mrow 
><mo mathsize="big" 
> &#x2211;</mo>
   </mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">&#x2208;</mo><mi 
>&#x03A9;</mi></mrow></munder 
><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>&#x03BC;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BD;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
      <!--l. 152--><p class="nopar" >
      </p></dd><dt class="enumerate-enumitem">
   3. </dt><dd 
class="enumerate-enumitem">A <span 
class="cmbx-12">strong stationary time</span>for <!--l. 155--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>,
      <!--l. 155--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>0</mn></mrow></math>
      if <!--l. 155--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
>
<mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x223C;</mo><mo class="qopname"> unif</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>,
      and <!--l. 157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
>
<mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow></math>
      is independent of <!--l. 157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>.
      </dd><dt class="enumerate-enumitem">
   4. </dt><dd 
class="enumerate-enumitem">The <span 
class="cmbx-12">ri&#xFB04;e shu&#xFB04;e </span>&#xFB01;rst cuts the deck randomly into two packets, one
      containing <!--l. 161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>
      cards and the other containing <!--l. 161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>k</mi></mrow></math>
      cards. Choose <!--l. 162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>,
      the number of cards cut according to the binomial density. Once the
      deck is cut into two packets, interleave the cards from each packet in
                                                                          

                                                                          
      any possible way, such that the cards from each packet keep their own
      relative order.
      </dd><dt class="enumerate-enumitem">
   5. </dt><dd 
class="enumerate-enumitem">A special case of this is the <span 
class="cmbx-12">perfect shu&#xFB04;e</span>, also know as the <span 
class="cmbx-12">faro</span>
      <span 
class="cmbx-12">shu&#xFB04;e </span>wherein the two packets are completely interleaved.
      </dd><dt class="enumerate-enumitem">
   6. </dt><dd 
class="enumerate-enumitem">A  <span 
class="cmbx-12">rising  sequence  </span>of  a  permutation  is  a  maximal  consecutive
      increasing subsequence.
      </dd><dt class="enumerate-enumitem">
   7. </dt><dd 
class="enumerate-enumitem">A <!--l. 174--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math><span 
class="cmbx-12">-shu&#xFB04;e</span>
      is another probability density on <!--l. 174--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>.
      Let <!--l. 175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
      be any positive integer. Cut the deck into <!--l. 175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
      packets of nonnegative sizes <!--l. 176--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></math>
      with <!--l. 177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">&#x22EF;</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi></mrow></math>
      but some of the <!--l. 177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>
      may be zero. Interleave the cards from each packet in any way, so long as
      the cards from each packet, so long as the cards from each packet keep
      the relative order among themselves. With a &#xFB01;xed packet structure,
      consider all interleavings equally likely.</dd></dl>
<!--l. 185--><p class="noindent" >__________________________________________________________________________
</p><!--l. 187--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/mathematicalideas.png" alt="Mathematical Ideas"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-5000"></a>Mathematical Ideas</h3>
<!--l. 190--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-6000"></a>General Setting</h4>
<!--l. 192--><p class="noindent" >An unopened deck of cards has the face-up order &#x0028;depending on manufacturer,
but typically in the U.S.&#x0029;, starting with the Ace of Spades: </p>
                                                                          

                                                                          
      <ul class="itemize1">
      <li class="itemize">Ace, 2, 3, 4, 5, 6, 7, 8, 9, 10, Jack, Queen, King of Spades,
      </li>
      <li class="itemize">Ace, 2, 3, 4, 5, 6, 7, 8, 9, 10, Jack, Queen, King of Diamonds,
      </li>
      <li class="itemize">King, Queen, Jack, 10, 9, 8, 7, 6, 5, 4, 3, 2, Ace of Clubs, then
      </li>
      <li class="itemize">King, Queen, Jack, 10, 9, 8, 7, 6, 5, 4, 3, 2, Ace of Hearts.</li></ul>
<!--l. 206--><p class="noindent" >Call this the initial order of the deck. Knowing this order is essential for some sleight
of hand tricks performed by a magician. For card players, shu&#xFB04;ing the deck to
remove this order is essential so that cards dealt from the deck come &#x201C;at
random&#x201D;, that is, in an order uniformly distributed over all possible deck
orders. The main question here is: Starting from this order, how many
shu&#xFB04;es are necessary to obtain a &#x201C;random&#x201D; deck order from the uniform
distribution?
</p><!--l. 214--><p class="indent" >   In terms of Markov processes, the questions are: What is the state space, what
is an appropriate transition probability matrix, what is the steady state
distribution, hopefully uniform, and how fast does the Markov process approach
the steady state distribution?
</p><!--l. 219--><p class="indent" >   For simplicity and de&#xFB01;niteness, let the cards in the initial deck order above be
numbered <!--l. 220--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
to <!--l. 220--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>5</mn><mn>2</mn></mrow></math>.
It will also be convenient to study much smaller decks of cards having
<!--l. 221--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
cards. The set of states for a Markov process modeling the order of the deck is
<!--l. 222--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>, the set of permutations
on <!--l. 223--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math> cards. For convenience,
set the initial state <!--l. 224--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow></math>
to be the identity permutation with probability
<!--l. 224--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>.
In other words, choose the initial distribution as not shu&#xFB04;ing the deck
yet.
</p><!--l. 228--><p class="indent" >   Consider a shu&#xFB04;e, that is, a re-ordering operation on a state that takes an
order to another order. For example, the ri&#xFB04;e shu&#xFB04;e, also called a dovetail shu&#xFB04;e
or lea&#xFB01;ng the cards, is a common type of shu&#xFB04;e that interleaves packets of cards.
                                                                          

                                                                          
A perfect ri&#xFB04;e shu&#xFB04;e, also called a faro shu&#xFB04;e, splits the deck exactly in half,
then interleaves cards alternately from each half. A perfect ri&#xFB02;e shu&#xFB04;e is di&#xFB03;cult
to perform, except for practiced magicians. More commonly, packets of adjacent
cards from unevenly split portions interleave, creating a new order for the deck
that nevertheless preserves some of the previous order in each packet. Thus a
particular ri&#xFB04;e shu&#xFB04;e is one of a whole family of ri&#xFB04;e shu&#xFB04;es, chosen with a
probability distribution on the family. This probability distribution then
induces a transition probability from state to state, and thus a Markov
process.
</p><!--l. 242--><p class="indent" >   Other types of shu&#xFB04;es have colorful names such as the Top-to-Random shu&#xFB04;e,
Hindu shu&#xFB04;e, pile shu&#xFB04;e, Corgi shu&#xFB04;e, Mongean shu&#xFB04;e, and Weave shu&#xFB04;e. Some
shu&#xFB04;e types are a family of possible re-orderings with probability distributions
di&#xFB00;erent from the ri&#xFB04;e shu&#xFB04;e, leading to di&#xFB00;erent transition probabilities, and
thus di&#xFB00;erent Markov processes.
</p><!--l. 249--><p class="indent" >   Going from card order <!--l. 249--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
to <!--l. 249--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi></mrow></math> is the same as
composing <!--l. 249--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math> with the
permutation <!--l. 250--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow></math>. Now identify
shu&#xFB04;es as functions on <!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="{"  close="}" ><mrow><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mi 
>n</mi></mrow></mfenced></mrow></math>
to <!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="{"  close="}" ><mrow><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mi 
>n</mi></mrow></mfenced></mrow></math>,
that is, permutations. Since a particular ri&#xFB04;e shu&#xFB04;e is one of a
whole family of ri&#xFB04;e shu&#xFB04;es, chosen with a probability distribution
<!--l. 255--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi></mrow></math>
from the family, the transition probabilities are
<!--l. 256--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>&#x03C0;</mi><mi 
>&#x03C3;</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C3;</mi><mo 
class="MathClass-rel">&#x2223;</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C0;</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>Q</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>.
So now the goal is to describe the probability distribution
<!--l. 258--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi></mrow></math> and
apply it to the Markov process.
</p>
   <div class="newtheorem">
<!--l. 261--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Remark.</span>  </span>This section uses a list notation for permutations. For example, the
notation <!--l. 263--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>3</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
represents the permutation with <!--l. 263--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math>,
<!--l. 264--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>2</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>3</mn></mrow></math>
and <!--l. 264--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>3</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>.
                                                                          

                                                                          
A common alternative explicit notation for the same permutation is
</p>
   <div class="math-display"><!--l. 266--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
 <mfenced separators="" 
open="("  close=")" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"><mn>1</mn></mtd><mtd 
class="array"  columnalign="center"><mn>2</mn></mtd><mtd 
class="array"  columnalign="center"><mn>3</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>2</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>3</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>1</mn></mtd></mtr> <!--*\c@MaxMatrixCols c--></mtable>                                                                                            </mrow></mfenced> <mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 272--><p class="nopar" > Writing the permutation in matrix form makes &#xFB01;nding the inverse obvious,
<!--l. 273--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>.
</p><!--l. 275--><p class="indent" >   Recall also that sequential permutations are applied from right to left.
Composing <!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
with the permutation <!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow></math>
gives <!--l. 277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi> <mo 
class="MathClass-bin">&#x2218;</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C3;</mi></mrow></math>.
If <!--l. 277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>3</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>,
then <!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>2</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
and <!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>3</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>3</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow> <mo 
class="MathClass-bin">&#x2218;</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>2</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>.
</p><!--l. 281--><p class="indent" >   This section does not use cycle notation for permutations.
</p>
   </div>
<!--l. 284--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-7000"></a>Top to Random Shu&#xFB04;e</h4>
<!--l. 284--><p class="noindent" >A particularly simple shu&#xFB04;e is the <span 
class="cmbx-12">Top-to-Random Shu&#xFB04;e</span>,
abbreviated TTRS. The TTRS takes the top card from a stack of
<!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
cards and inserts it in the gap between the
<!--l. 288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>k</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>th card and the
<!--l. 288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>th card in the deck. See
Figure&#x00A0;<a 
href="#x1-70011">1<!--tex4ht:ref: fig:cardshuffling:cards1 --></a>. Note that <!--l. 290--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>
                                                                          

                                                                          
is possible, in which case the top card returns to the top. Likewise,
<!--l. 291--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math> is
also permitted, in which case the top card moves to the bottom of the card
stack.
</p><!--l. 295--><p class="indent" >   Consider the order of the cards to be a permutation on
<!--l. 295--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
symbols. The TTRS is naturally a &#xFB01;nite Markov chain
<!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math> for
<!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>0</mn></mrow></math> with
<!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>. Set
<!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow></math>, the
identity permutation. The transition probabilities are
</p>
   <div class="math-display"><!--l. 299--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>&#x2032;</mi></mrow></msup 
><mo 
class="MathClass-rel">&#x2223;</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
>
<mi 
>t</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C3;</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo>  <mfenced separators="" 
open="{"  close="" ><mrow> <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>n</mi></mrow></mfrac><mspace width="1em" class="quad"/></mtd><mtd 
class="array"  columnalign="left"><mstyle 
class="text"><mtext  ></mtext><mstyle 
class="math"><msup><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mi 
>&#x2032;</mi></mrow></msup 
></mstyle><mtext  >&#x00A0;is&#x00A0;a&#x00A0;TTRS&#x00A0;of&#x00A0;</mtext><mstyle 
class="math"><mi 
>&#x03C3;</mi></mstyle><mtext  ></mtext></mstyle></mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"><mn>0</mn><mspace width="1em" class="quad"/></mtd><mtd 
class="array"  columnalign="left"><mstyle 
class="text"><mtext  >otherwise</mtext></mstyle>           </mtd></mtr> <!--@{}l@{\quad }l@{}--></mtable>                                                                        </mrow></mfenced>
</mrow></math></div>
<!--l. 305--><p class="nopar" > de&#xFB01;ning the transition probability matrix
<!--l. 305--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>P</mi></mrow></math>. Then
after <!--l. 305--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi></mrow></math>
TTRS shu&#xFB04;es, the order of the deck has a probability distribution
<!--l. 306--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>t</mi></mrow></msup 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
>
<mn>0</mn></mrow></msub 
></mrow></math> on
<!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>, where with an
overload of notation <!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow></math>
is the vector with a <!--l. 308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
in the position for <!--l. 308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C3;</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow></math>
and <!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>
elsewhere, representing the initial state. The Markov chain
<!--l. 310--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>
induced by the TTRS is irreducible, see the exercises. It is also immediate that
                                                                          

                                                                          
<!--l. 311--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math> is aperiodic
since it is possible that the top card can recur back on top. Therefore, this Markov
chain must converge to a stationary distribution and this section will later prove
that <!--l. 314--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>t</mi></mrow></msup 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
>
<mn>0</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x2192;</mo><mo class="qopname"> unif</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>.
</p>
   <div class="newtheorem">
<!--l. 318--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Example.</span>  </span>The transition matrix for the TTRS on a deck with three cards is
</p>
   <div class="math-display"><!--l. 320--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mspace width="3.26288pt" class="tmspace"/><mfenced separators="" 
open="("  close=")" ><mrow>   
<img 
src="cardshuffling0x.png" alt="       &#x005B;123 &#x005D;  &#x005B;213 &#x005D;  &#x005B;231&#x005D;  &#x005B;132&#x005D;  &#x005B;312&#x005D;  &#x005B;321&#x005D;
&#x005B;123 &#x005D;    13      13     13      0      0      0
&#x005B;213 &#x005D;    1      1     0      1      0      0
         3      3     1      3      1      1
&#x005B;231 &#x005D;    0     0      3      01      31      31
&#x005B;132 &#x005D;    0     0      0      3      3      3
&#x005B;312 &#x005D;    13     0      0      13      13      0
&#x005B;321 &#x005D;    0      1     1      0      0      1
                3     3                    3   "  class="pic-halign"  />                                            <mspace width="0.3em" class="thinspace"/></mrow></mfenced><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 330--><p class="nopar" >
</p><!--l. 332--><p class="indent" >   If the card deck is initially in order <!--l. 332--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
to <!--l. 332--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
from top to bottom, how many TTRS shu&#xFB04;es does it take for the deck to be
su&#xFB03;ciently shu&#xFB04;ed? Starting with the identity ordering, the density of the
permutations after <!--l. 335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
top-to-random shu&#xFB04;es is the &#xFB01;rst row of <!--l. 336--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>7</mn></mrow></msup 
></mrow></math>.
Numerically,
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 337--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><msup><mrow 
>
<mi 
>P</mi></mrow><mrow 
><mn>7</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo>  <mfenced separators="" 
open="("  close=")" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>4</mn><mn>4</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>9</mn><mn>0</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd></mtr> <!--*\c@MaxMatrixCols c--></mtable>                                     </mrow></mfenced> <mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 348--><p class="nopar" > That is, <!--l. 348--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
shu&#xFB04;es of the 3-card deck gets close to the stationary density, which turns out
to be the uniform density. The eigenvalues of <!--l. 350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>P</mi></mrow></math>
are <!--l. 350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>3</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>3</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>3</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mn>0</mn><mo 
class="MathClass-punc">,</mo> <mn>0</mn></mrow></math>.
</p>
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x1-70011"></a>
                                                                          
<p class="indent">  <img
src="cardshuffling-1.png" alt="Schematic Top-to-Random-Shufffle">
/>
                                                                          
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">Schematic drawing of the Top-to-Random-Shu&#xFB04;e.</span></div><!--tex4ht:label?: x1-70011 -->
                                                                          

                                                                          
   </div><hr class="endfigure" />
   <div class="newtheorem">
<!--l. 388--><p class="noindent" ><span class="head">
<a 
 id="x1-7002r1"></a>
<span 
class="cmbx-12">Lemma 1.</span>  </span><span 
class="cmti-12">At any time </span><!--l. 389--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi></mrow></math><span 
class="cmti-12">,</span>
<span 
class="cmti-12">if </span><!--l. 389--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>
<span 
class="cmti-12">cards appear beneath the card labeled </span><!--l. 390--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math><span 
class="cmti-12">,</span>
<span 
class="cmti-12">then these cards appear in any order with equal probability.</span>
</p>
   </div>
<!--l. 394--><p class="indent" >
</p>
   <div class="proof">
<!--l. 395--><p class="indent" >   <span class="head">
<span 
class="cmti-12">Proof.</span> </span>The proof is by induction on <!--l. 395--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi></mrow></math>.
The base case <!--l. 395--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
is trivial. Suppose that the claim is true for some <!--l. 396--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn></mrow></math>.
In the transition to <!--l. 397--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>,
two cases can occur, see Figure&#x00A0;<a 
href="#x1-70032">2<!--tex4ht:ref: fig:cardshuffling:cards2 --></a> for a schematic diagram. First, the top card
is randomly placed above the card labeled <!--l. 399--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
that is somewhere in the stack. Then nothing is changed and the proof is
complete. Otherwise, the top card is placed in one of the <!--l. 401--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>
available spaces below the last card labeled <!--l. 402--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
that is somewhere in the stack. The probability of any particular one of these
arrangements is
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 405--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                     <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>k</mi><mo 
class="MathClass-punc">!</mo></mrow></mfrac> <mo 
class="MathClass-bin">&#x22C5;</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfrac> <mo 
class="MathClass-rel">=</mo>     <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-punc">!</mo></mrow></mfrac>
</mrow></math></div>
<!--l. 407--><p class="nopar" >                                                                     where
<!--l. 407--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>k</mi><mo 
class="MathClass-punc">!</mo></mrow></mfrac></mrow></math>
comes        from        the        induction        hypothesis        and        the
<!--l. 408--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>k</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></mfrac></mrow></math>
comes from the TTRS. The proof is complete.                                     &#x25A1;
</p>
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                          
<p class="indent">  <img
src="cardshuffling-2.png" alt="Schematic diagram of proof">
/>

                                                                          
<a 
 id="x1-70032"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Schematic diagram of the proof of the Lemma.</span></div><!--tex4ht:label?: x1-70032 -->
                                                                          

                                                                          
   </div><hr class="endfigure" />
   <div class="newtheorem">
<!--l. 477--><p class="noindent" ><span class="head">
<a 
 id="x1-7004r2"></a>
<span 
class="cmbx-12">Theorem 2.</span>  </span> <span 
class="cmti-12">Let </span><!--l. 478--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>
<span 
class="cmti-12">be the &#xFB01;rst time that card </span><!--l. 479--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
<span 
class="cmti-12">reaches the top of the deck. Then </span><!--l. 479--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-bin">+</mo><mn>1</mn>
           </mrow></msup 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow></math>
<span 
class="cmti-12">is uniform on </span><!--l. 480--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math><span 
class="cmti-12">.</span>
<span 
class="cmti-12">Furthermore, whatever permutation arises at time </span><!--l. 481--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>
<span 
class="cmti-12">is independent of </span><!--l. 482--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math><span 
class="cmti-12">.</span>
</p>
   </div>
<!--l. 485--><p class="indent" >
</p>
   <div class="proof">
<!--l. 486--><p class="indent" >   <span class="head">
<span 
class="cmti-12">Proof.</span> </span>The    proof    follows    from    the    Lemma,    since    at    time
<!--l. 486--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>
the
<!--l. 487--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math>
cards                                        below                                        card
<!--l. 487--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
will           be           uniformly           distributed           over           the
<!--l. 488--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-punc">!</mo></mrow></math>
possible              permutations.              Then              at              time
<!--l. 489--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>
card
<!--l. 489--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
is inserted uniformly at random in the deck.                                        &#x25A1;
</p>
   </div>
   <div class="newtheorem">
<!--l. 493--><p class="noindent" ><span class="head">
                                                                          

                                                                          
<span 
class="cmti-12">Remark.</span>  </span>Waiting for <!--l. 494--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>
is the same as waiting for completion in the &#x201C;coupon collectors problem in
reverse&#x201D;. More precisely, collecting a coupon here is putting the top card
below the card labeled <!--l. 497--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>.
The &#xFB01;rst card is hard to put under <!--l. 497--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>,
in fact it happens with probability <!--l. 498--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
>  <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></mfrac></mrow></math>
but it gets easier as time goes on. This motivates the later assertions that
<!--l. 499--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x1D53C;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x0398;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
and that <!--l. 500--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mn>1</mn> <mo 
class="MathClass-rel">&#x2265;</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>c</mi><mi 
>n</mi></mrow></mfenced> <mo 
class="MathClass-rel">&#x2264;</mo><msup><mrow 
><mi mathvariant="normal">e</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>c</mi></mrow></msup 
></mrow></math>
for all <!--l. 501--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>0</mn></mrow></math>.
See below for more details.
</p>
   </div>
   <div class="newtheorem">
<!--l. 505--><p class="noindent" ><span class="head">
<span 
class="cmti-12">De&#xFB01;nition.</span>  </span>If <!--l. 506--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi></mrow></math>
and <!--l. 506--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BD;</mi></mrow></math>
are probability distributions on <!--l. 506--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03A9;</mi></mrow></math>,
the <span 
class="cmbx-12">total variation distance </span>of <!--l. 507--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi></mrow></math>
from <!--l. 507--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BD;</mi></mrow></math>
is
</p>
   <div class="math-display"><!--l. 510--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
          <mo 
class="MathClass-rel">&#x2225;</mo><mi 
>&#x03BC;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BD;</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
><mi 
>T</mi><mi 
>V</mi> </mrow></msub 
> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mo class="qopname"> sup</mo> </mrow><mrow 
><mi 
>A</mi><mo 
class="MathClass-rel">&#x2282;</mo><mi 
>&#x03A9;</mi></mrow></munder 
><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>&#x03BC;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BD;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-rel">&#x007C;</mo> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><munder class="msub"><mrow 
><mo mathsize="big" 
> &#x2211;</mo>
   </mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-rel">&#x2208;</mo><mi 
>&#x03A9;</mi></mrow></munder 
><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>&#x03BC;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x03BD;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 514--><p class="nopar" >
                                                                          

                                                                          
</p>
   </div>
   <div class="newtheorem">
<!--l. 517--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Remark.</span>  </span>Probability                                                        distributions
<!--l. 518--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi></mrow></math>
and
<!--l. 518--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BD;</mi></mrow></math>
are  far  apart  in  total  variation  distance  if  there  is  a  &#x201C;bad  event&#x201D;
<!--l. 519--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
such                                                                                        that
<!--l. 520--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi></mrow></math>
and
<!--l. 520--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BD;</mi></mrow></math>
measure
<!--l. 520--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
di&#xFB00;erently.
</p>
   </div>
   <div class="newtheorem">
<!--l. 523--><p class="noindent" ><span class="head">
<span 
class="cmti-12">De&#xFB01;nition.</span>  </span>De&#xFB01;ne <!--l. 524--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>
as a <span 
class="cmbx-12">strong stationary time </span>for <!--l. 526--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>,
<!--l. 526--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>0</mn></mrow></math>
if <!--l. 526--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
>
<mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x223C;</mo><mo class="qopname"> unif</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>,
and <!--l. 528--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
>
<mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow></math>
is independent of <!--l. 528--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>.
</p>
   </div>
   <div class="newtheorem">
<!--l. 532--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Remark.</span>  </span>A <span 
class="cmti-12">stopping time </span>is a rule which tells the process to &#x201C;stop&#x201D; depending
                                                                          

                                                                          
on the current value of the process. The stopping time is strong stationary if
conditional                      on                      stopping                      after
<!--l. 535--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>
steps the value of the process is uniform on the state space.
</p>
   </div>
   <div class="newtheorem">
<!--l. 539--><p class="noindent" ><span class="head">
<a 
 id="x1-7005r3"></a>
<span 
class="cmbx-12">Lemma 3.</span>  </span> <span 
class="cmti-12">Let </span><!--l. 540--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi></mrow></math>
<span 
class="cmti-12">be a probability distribution on a &#xFB01;nite group </span><!--l. 541--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>G</mi></mrow></math>
<span 
class="cmti-12">inducing an irreducible and aperiodic Markov chain with transition probabilities</span>
<!--l. 543--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
<span 
class="cmti-12">from </span><!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
<span 
class="cmti-12">to </span><!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi></mrow></math><span 
class="cmti-12">.</span>
<span 
class="cmti-12">Let </span><!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C4;</mi></mrow></math>
<span 
class="cmti-12">be a strong stationary time for </span><!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi></mrow></math>
<span 
class="cmti-12">and </span><!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>U</mi></mrow></math>
<span 
class="cmti-12">the uniform distribution. Then</span>
</p>
   <div class="math-display"><!--l. 546--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>Q</mi></mrow><mrow 
><mi 
>&#x03C4;</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
>
<mi 
>T</mi><mi 
>V</mi> </mrow></msub 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced>
</mrow></math></div>
<!--l. 548--><p class="nopar" >                                   <span 
class="cmti-12">for                                           all</span>
<!--l. 548--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>0</mn></mrow></math>
</p>
   </div>
                                                                          

                                                                          
   <div class="newtheorem">
<!--l. 551--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Remark.</span>  </span>The  hypotheses  irreducible  and  aperiodic  may  not  be  strictly
necessary,  but  occur  here  because  both  are  common  in  theorems  about
Markov chains.
</p>
   </div>
<!--l. 557--><p class="indent" >
</p>
   <div class="proof">
<!--l. 558--><p class="indent" >   <span class="head">
<span 
class="cmti-12">Proof.</span> </span>For any <!--l. 558--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi> <mo 
class="MathClass-rel">&#x2282;</mo> <mi 
>G</mi></mrow></math>
</p><!--tex4ht:inline--><!--l. 567--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
         <mtr><mtd 
columnalign="right" class="align-odd"><msup><mrow 
><mi 
>Q</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mtd>         <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
>
<mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <mi 
>A</mi></mrow></mfenced><mspace width="2em"/></mtd>                                              <mtd 
columnalign="right" class="align-label"></mtd>         <mtd 
class="align-label">
         <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>               <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mo mathsize="big" 
> &#x2211;</mo>
   </mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-rel">&#x2264;</mo><mi 
>k</mi></mrow></munder 
><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>j</mi></mrow></mfenced> <mo 
class="MathClass-bin">+</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced><mspace width="2em"/></mtd>              <mtd 
columnalign="right" class="align-label"></mtd>         <mtd 
class="align-label">
         <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>               <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mo mathsize="big" 
> &#x2211;</mo>
   </mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-rel">&#x2264;</mo><mi 
>k</mi></mrow></munder 
><mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>j</mi></mrow></mfenced> <mo 
class="MathClass-bin">+</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <mi 
>A</mi><mo 
class="MathClass-rel">&#x2223;</mo><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced><mspace width="2em"/></mtd>         <mtd 
columnalign="right" class="align-label"></mtd>         <mtd 
class="align-label">
         <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"></mtd>               <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mfenced separators="" 
open="("  close=")" ><mrow><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <mi 
>A</mi><mo 
class="MathClass-rel">&#x2223;</mo><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></mfenced> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced><mspace width="2em"/></mtd>               <mtd 
columnalign="right" class="align-label"></mtd>         <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 568--><p class="noindent" >and because <!--l. 568--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo 
class="MathClass-rel">&#x007C;</mo><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo> <mi 
>A</mi><mo 
class="MathClass-rel">&#x2223;</mo><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-rel">&#x2264;</mo> <mn>1</mn></mrow></math>
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 569--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                  <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>Q</mi></mrow><mrow 
><mi 
>&#x03C4;</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
>
<mi 
>T</mi><mi 
>V</mi> </mrow></msub 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 571--><p class="nopar" >                                                                         &#x25A1;
</p>
   </div>
   <div class="newtheorem">
<!--l. 574--><p class="noindent" ><span class="head">
<a 
 id="x1-7006r4"></a>
<span 
class="cmbx-12">Lemma 4.</span>  </span>  <span 
class="cmti-12">Sample  uniformly  with  replacement  from  an  urn  with</span>
<!--l. 576--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
<span 
class="cmti-12">balls.                                                                                   Let</span>
<!--l. 576--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>V</mi> </mrow></math>
<span 
class="cmti-12">be the number of draws required until each ball has been drawn at least once.</span>
<span 
class="cmti-12">Then</span>
</p>
   <div class="math-display"><!--l. 578--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                               <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>V</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>c</mi><mi 
>n</mi></mrow></mfenced> <mo 
class="MathClass-rel">&#x2264;</mo><msup><mrow 
><mi mathvariant="normal">e</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>c</mi></mrow></msup 
>
</mrow></math></div>
                                                                          

                                                                          
<!--l. 580--><p class="nopar" > <span 
class="cmti-12">for </span><!--l. 580--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>0</mn></mrow></math>
<span 
class="cmti-12">and </span><!--l. 580--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>1</mn></mrow></math><span 
class="cmti-12">.</span>
</p>
   </div>
   <div class="newtheorem">
<!--l. 583--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Remark.</span>  </span>The            lemma            statement            is            another
formulation of the coupon collectors problem. The usual formulation has
<!--l. 587--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
di&#xFB00;erent  types  of  coupons  or  prizes  in  a  cereal  box.  On  each  draw,
one  obtains  a  coupon  or  prize  equally  likely  to  be  any  one  of  the
<!--l. 589--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
types. The goal is to &#xFB01;nd the expected number of coupons one needs to gather
before obtaining a complete set of at least one of each type.
</p>
   </div>
<!--l. 594--><p class="indent" >
</p>
   <div class="proof">
<!--l. 595--><p class="indent" >   <span class="head">
<span 
class="cmti-12">Proof.</span> </span>Let <!--l. 595--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>m</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>c</mi><mi 
>n</mi></mrow></math>.
For each ball <!--l. 595--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
let <!--l. 595--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></mrow></math>
be the event &#x201C;ball <!--l. 596--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
not drawn in the &#xFB01;rst <!--l. 596--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>m</mi></mrow></math>
draws. Then
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 598--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
    <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>V</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>m</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>&#x22C3;</mo>
  </mrow><mrow 
><mi 
>b</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msub><mrow 
><mi 
>A</mi></mrow><mrow 
>
<mi 
>b</mi></mrow></msub 
></mrow></mfenced> <mo 
class="MathClass-rel">&#x2264;</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
>&#x2211;</mo>
  </mrow><mrow 
><mi 
>b</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
>
<mi 
>b</mi></mrow></msub 
></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi><msup><mrow 
> <mfenced separators="" 
open="("  close=")" ><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac></mrow></mfenced></mrow><mrow 
><mi 
>m</mi></mrow></msup 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>n</mi><msup><mrow 
><mi mathvariant="normal">e</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>m</mi><mo 
class="MathClass-bin">&#x2215;</mo><mi 
>n</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><msup><mrow 
> <mi mathvariant="normal">e</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>c</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 602--><p class="nopar" > See the exercises for a proof of the second inequality.                            &#x25A1;
</p>
   </div>
<!--l. 621--><p class="indent" >   For simplicity in what follows, set
<!--l. 621--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
>
<mi 
>T</mi><mi 
>V</mi> </mrow></msub 
></mrow></math>. Then
<!--l. 622--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math> measures
how close <!--l. 622--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
repeated shu&#xFB04;es get the deck to being shu&#xFB04;ed according to the uniform
density.
</p>
   <div class="newtheorem">
<!--l. 625--><p class="noindent" ><span class="head">
<a 
 id="x1-7007r5"></a>
<span 
class="cmbx-12">Theorem 5.</span>  </span><span 
class="cmti-12">For the TTRS shu&#xFB04;e</span>
      </p><dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
   <span 
class="cmti-12">1.</span> </dt><dd 
class="enumerate-enumitem"><!--l. 629--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <msup><mrow 
><mi 
>&#x1D716;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>&#x1D716;</mi></mrow></math>
      <span 
class="cmti-12">for </span><!--l. 629--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
      <span 
class="cmti-12">su&#xFB03;ciently large.</span>
      </dd><dt class="enumerate-enumitem">
   <span 
class="cmti-12">2.</span> </dt><dd 
class="enumerate-enumitem"><!--l. 632--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>C</mi><msup><mrow 
><mi 
>&#x1D716;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>&#x1D716;</mi></mrow></math>
      <span 
class="cmti-12">for </span><!--l. 633--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
      <span 
class="cmti-12">su&#xFB03;ciently large.</span></dd></dl>
                                                                          

                                                                          
   </div>
<!--l. 637--><p class="indent" >
</p>
   <div class="proof">
<!--l. 638--><p class="indent" >   <span class="head">
<span 
class="cmti-12">Proof.</span> </span>
      </p><dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
   1. </dt><dd 
class="enumerate-enumitem">Theorem&#x00A0;<a 
href="#x1-7004r2">2<!--tex4ht:ref: thm:cardshuffling:tautop --></a> shows that <!--l. 641--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>,
      the &#xFB01;rst time that the original bottom card has come to the top and
      been inserted into the deck is a strong uniform time for the TTRS.
      </dd><dt class="enumerate-enumitem">
   2. </dt><dd 
class="enumerate-enumitem">The goal is to show that <!--l. 646--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
></mrow></math>
      has the same distribution as <!--l. 647--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>V</mi> </mrow></math>
      in Lemma&#x00A0;<a 
href="#x1-7006r4">4<!--tex4ht:ref: lem:cardshuffling:coupon --></a>. Then the upper bound follows from Lemma&#x00A0;<a 
href="#x1-7006r4">4<!--tex4ht:ref: lem:cardshuffling:coupon --></a> and Lemma&#x00A0;<a 
href="#x1-7005r3">3<!--tex4ht:ref: lem:cardshuffling:stoptime --></a>.
      </dd><dt class="enumerate-enumitem">
   3. </dt><dd 
class="enumerate-enumitem">Write
<div class="math-display"><!--l. 654--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
        <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">&#x22EF;</mo> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >top</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow>
</mrow></math></div>
      <!--l. 658--><p class="nopar" > where <!--l. 658--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>
      is the time until card <!--l. 658--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>
      is placed under the original bottom card.
      </p></dd><dt class="enumerate-enumitem">
   4. </dt><dd 
class="enumerate-enumitem">When exactly <!--l. 661--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>
                                                                          

                                                                          
      cards are under the original bottom card <!--l. 662--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>,
      the chance that the current top card is inserted below <!--l. 663--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
      is <!--l. 663--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow>
  <mrow 
><mi 
>n</mi></mrow></mfrac>  </mrow></math>
      and hence the random variable <!--l. 664--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
      has geometric distribution
<div class="math-display"><!--l. 666--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                  <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>j</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac><msup><mrow 
>   <mfenced separators="" 
open="("  close=")" ><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac>  </mrow></mfenced></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
>
</mrow></math></div>
      <!--l. 669--><p class="nopar" > for <!--l. 669--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>1</mn></mrow></math>.
      </p></dd><dt class="enumerate-enumitem">
   5. </dt><dd 
class="enumerate-enumitem">The random variable <!--l. 671--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>V</mi> </mrow></math>
      in Lemma&#x00A0;<a 
href="#x1-7006r4">4<!--tex4ht:ref: lem:cardshuffling:coupon --></a> can be written as
<div class="math-display"><!--l. 673--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
         <mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>V</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">&#x22EF;</mo> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>1</mn></mrow></msub 
>
</mrow></math></div>
      <!--l. 676--><p class="nopar" > where <!--l. 676--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>
      is the number of draws required until <!--l. 676--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>
      distinct balls have been drawn at least once.
                                                                          

                                                                          
      </p></dd><dt class="enumerate-enumitem">
   6. </dt><dd 
class="enumerate-enumitem">After <!--l. 679--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>i</mi></mrow></math>
      distinct balls have been drawn, the chance that a draw produces a
      not-previously-drawn ball is <!--l. 680--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>i</mi></mrow>
 <mrow 
><mi 
>n</mi></mrow></mfrac>  </mrow></math>.
      So <!--l. 681--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
></mrow></math>
      has distribution
<div class="math-display"><!--l. 682--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                  <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>j</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>i</mi></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac><msup><mrow 
>   <mfenced separators="" 
open="("  close=")" ><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>i</mi></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac>  </mrow></mfenced></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
>
</mrow></math></div>
      <!--l. 685--><p class="nopar" > for <!--l. 685--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi> <mo 
class="MathClass-rel">&#x2265;</mo> <mn>1</mn></mrow></math>.
      </p></dd><dt class="enumerate-enumitem">
   7. </dt><dd 
class="enumerate-enumitem">Comparing, the corresponding terms <!--l. 687--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
      and <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>V</mi> </mrow><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>i</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
></mrow></math>
      have the same distribution, since the summands in each sum are independent,
      it follows that the sums <!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C4;</mi></mrow></math>
      and <!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>V</mi> </mrow></math>
      have the same distribution, as required.
      </dd><dt class="enumerate-enumitem">
   8. </dt><dd 
class="enumerate-enumitem">To prove the lower bound, &#xFB01;x <!--l. 693--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>
      and <!--l. 693--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></mrow></math>
      be the set of con&#xFB01;gurations of the deck such that the bottom <!--l. 694--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>
      original cards stay in their original relative order. Plainly <!--l. 696--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>j</mi><mo 
class="MathClass-punc">!</mo></mrow></mfrac></mrow></math>.
      </dd><dt class="enumerate-enumitem">
   9. </dt><dd 
class="enumerate-enumitem">Let <!--l. 698--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>k</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mi 
>n</mi></mrow></math>
      where <!--l. 698--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2192;</mo><mi 
>&#x221E;</mi></mrow></math>.
      The goal is to show <!--l. 699--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
>
<mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2192;</mo> <mn>1</mn></mrow></math>
      as <!--l. 699--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">&#x2192;</mo><mi 
>&#x221E;</mi></mrow></math>
                                                                          

                                                                          
      for &#xFB01;xed <!--l. 700--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>.
      Then <!--l. 700--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>d</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>k</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo><mo class="qopname"> sup</mo><mrow ><mo 
class="MathClass-open">&#x007B;</mo><mrow><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
>
<mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x007D;</mo></mrow><mo 
class="MathClass-rel">&#x2192;</mo> <mn>1</mn></mrow></math>
      as <!--l. 701--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">&#x2192;</mo><mi 
>&#x221E;</mi></mrow></math>
      for &#xFB01;xed <!--l. 701--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>,
      establishing the lower bound.
      </dd><dt class="enumerate-enumitem">
  10. </dt><dd 
class="enumerate-enumitem">To prove <!--l. 704--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
>
<mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2192;</mo> <mn>1</mn></mrow></math>
      as <!--l. 704--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">&#x2192;</mo><mi 
>&#x221E;</mi></mrow></math>,
      note <!--l. 704--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>A</mi></mrow><mrow 
>
<mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2265;</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>k</mi></mrow></mfenced></mrow></math>
      because <!--l. 705--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C4;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
></mrow></math>
      is distributed as the time for the card initially <!--l. 707--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>th
      from the bottom to come to the top and be inserted. If this has not
      happened by time <!--l. 708--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>,
      then the original bottom <!--l. 709--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>
      cards must still be in their relative order at time <!--l. 710--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>.
      </dd><dt class="enumerate-enumitem">
  11. </dt><dd 
class="enumerate-enumitem">It su&#xFB03;ces to show that <!--l. 712--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>k</mi></mrow></mfenced> <mo 
class="MathClass-rel">&#x2192;</mo> <mn>0</mn></mrow></math>
      as <!--l. 713--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">&#x2192;</mo><mi 
>&#x221E;</mi></mrow></math> for
      &#xFB01;xed <!--l. 713--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>.
      This follows from Chebyshev&#x2019;s inequality. Note that
      <!--tex4ht:inline--><!--l. 719--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                   <mtr><mtd 
columnalign="right" class="align-odd"><mi 
>&#x1D53C;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></mfenced></mtd>                      <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>f</mi><mi 
>r</mi><mi 
>a</mi><mi 
>c</mi><mi 
>n</mi><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mspace width="2em"/></mtd>                           <mtd 
columnalign="right" class="align-label"></mtd>                   <mtd 
class="align-label">
                   <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><mo class="qopname"> Var</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></mfenced></mtd>                   <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo><msup><mrow 
> <mfenced separators="" 
open="("  close=")" ><mrow>   <mfrac><mrow 
><mi 
>n</mi></mrow>
<mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfrac></mrow></mfenced> </mrow><mrow 
><mn>2</mn></mrow></msup 
> <mfenced separators="" 
open="("  close=")" ><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac>  </mrow></mfenced><mspace width="2em"/></mtd>                <mtd 
columnalign="right" class="align-label"></mtd>                <mtd 
class="align-label">
<mspace width="2em"/></mtd></mtr></mtable></math>
                                                                          

                                                                          
      <!--l. 720--><p class="noindent" >and so
</p>
<div class="math-display"><!--l. 721--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
               <mi 
>&#x1D53C;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></mfenced> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mi 
>j</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
>   <mfrac><mrow 
><mi 
>n</mi></mrow>
<mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>O</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow>
</mrow></math></div>
      <!--l. 724--><p class="nopar" > and
</p>
<div class="math-display"><!--l. 725--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
            <mo class="qopname">Var</mo><!--nolimits--> <mfenced separators="" 
open="["  close="]" ><mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></mfenced> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mi 
>j</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></munderover 
><msup><mrow 
> <mfenced separators="" 
open="("  close=")" ><mrow>   <mfrac><mrow 
><mi 
>n</mi></mrow>
<mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfrac></mrow></mfenced> </mrow><mrow 
><mn>2</mn></mrow></msup 
> <mfenced separators="" 
open="("  close=")" ><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac>  </mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>O</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
      <!--l. 729--><p class="nopar" > Then using Chebyshev&#x2019;s inequality gives
      <!--l. 729--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><mi 
>&#x03C4;</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <msub><mrow 
><mi 
>&#x03C4;</mi></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>k</mi></mrow></mfenced> <mo 
class="MathClass-rel">&#x2192;</mo> <mn>0</mn></mrow></math> as
      <!--l. 730--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">&#x2192;</mo><mi 
>&#x221E;</mi></mrow></math> for
      &#xFB01;xed <!--l. 730--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>j</mi></mrow></math>.</p></dd></dl>
                                                                         &#x25A1;
   </div>
   <div class="newtheorem">
<!--l. 735--><p class="noindent" ><span class="head">
                                                                          

                                                                          
<span 
class="cmti-12">Remark.</span>  </span>The        strong        stationary        time        property        of
<!--l. 736--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C4;</mi></mrow></math>
played no role in establishing the lower bound. The proof gets lower bounds
by                         guessing                         some                         set
<!--l. 738--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
for                                                                                        which
<!--l. 738--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
should be large and then using
</p>
   <div class="math-display"><!--l. 740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                        <mi 
>d</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>k</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
>
<mstyle 
class="text"><mtext  >TV</mtext></mstyle></mrow></msub 
> <mo 
class="MathClass-rel">&#x2265;</mo><mo 
class="MathClass-rel">&#x007C;</mo><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>A</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mo 
class="MathClass-rel">&#x007C;</mo><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 742--><p class="nopar" >
</p>
   </div>
<!--l. 744--><p class="indent" >   Note that <!--l. 744--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <msup><mrow 
><mi 
>&#x1D716;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <mi 
>o</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
and <!--l. 745--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <msup><mrow 
><mi 
>&#x1D716;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>o</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>. This gives
the sense that <!--l. 746--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi></mrow></math>
shu&#xFB04;es is about the right number of shu&#xFB04;es needed to bring the deck
close to being uniformly shu&#xFB04;ed. This gives a cut-o&#xFB00; phenomenon, that is
<!--l. 748--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi></mrow></math> is a critical number
of shu&#xFB04;es such that <!--l. 749--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>o</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2248;</mo> <mn>0</mn></mrow></math>
but <!--l. 749--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo class="qopname"> log</mo><!--nolimits--> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>o</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2248;</mo> <mn>1</mn></mrow></math>.
The distance from the stationary density changes abruptly at some value, see
Figure&#x00A0;<a 
href="#x1-70213">3<!--tex4ht:ref: fig:cardshuffling:cards3 --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                          
<p class="indent">  <img
src="cardshuffling-3.png" alt="Schematic graph of cut-off">
/>

                                                                          
<a 
 id="x1-70213"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Schematic graph of the cut-o&#xFB00; phenomenon for the Total Variation
distance of the Markov chain distribution from the uniform distribution as a
function of the number of steps.</span></div><!--tex4ht:label?: x1-70213 -->
                                                                          

                                                                          
   </div><hr class="endfigure" />
<!--l. 787--><p class="indent" >   Note that this is quite di&#xFB00;erent from the asymptotics of
<!--l. 788--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-rel">&#x2225;</mo><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>U</mi><msub><mrow 
><mo 
class="MathClass-rel">&#x2225;</mo></mrow><mrow 
>
<mi 
>T</mi><mi 
>V</mi> </mrow></msub 
></mrow></math>. Perron-Frobenius
theory says <!--l. 789--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>P</mi> </mrow></msub 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x223C;</mo> <mi 
>a</mi><msup><mrow 
><mi 
>&#x03BB;</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></math>
where <!--l. 789--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BB;</mi></mrow></math> is
the second largest eigenvalue, but the long-time asymptotics miss the
cut-o&#xFB00;.
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-8000"></a>The Ri&#xFB04;e Shu&#xFB04;e</h4>
<!--l. 799--><p class="noindent" >A more realistic model of shu&#xFB04;ing a deck cards is the commonly used
<span 
class="cmbx-12">ri&#xFB04;e shu&#xFB04;e</span>. The ri&#xFB04;e shu&#xFB04;e is sometimes called the GSR shu&#xFB04;e
since Gilbert and Shannon and independently Reeds &#xFB01;rst analyzed
it. First cut the deck randomly into two packets, one containing
<!--l. 804--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math> cards and the other
containing <!--l. 805--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>k</mi></mrow></math> cards. Choose
the number of cards cut, <!--l. 805--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>,
according to the binomial density, meaning that the probability of the cut occurring
after <!--l. 807--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math> cards
is exactly <!--l. 807--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mi 
>n</mi></mrow> 
<mrow><mi 
>k</mi></mrow></mfrac></mfenced> </mrow></math>.
</p><!--l. 810--><p class="indent" >   Once the deck is cut into two packets, interleave the cards from each
packet in any possible way, such that the cards from each packet keep
their own relative order. This means the cards originally in positions
<!--l. 812--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo> <mn>3</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></math>
must still be in the same order after shu&#xFB04;ing, even if there are other
cards in between. The same goes for cards originally in positions
<!--l. 815--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><mi 
>n</mi></mrow></math>. This
requirement is quite natural, considering how a person shu&#xFB04;es two packets of cards,
one in each hand. The cards in the left hand must still be in the same relative
order in the shu&#xFB04;ed deck, no matter how they interleave with the cards in the
other packet, because the cards drop in order while shu&#xFB04;ing. The same goes for
the cards in the right hand. See Figure&#x00A0;<a 
href="#x1-80014">4<!--tex4ht:ref: fig:cardshuffling:riffle --></a> for an illustration of a ri&#xFB04;e shu&#xFB04;e on a
<!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mn>0</mn></mrow></math>-card
deck.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                          
<p class="indent">  <img
src="cardshuffling-4.png" alt="Riffle shuffle cut and interleave">
/>

                                                                          
<a 
 id="x1-80014"></a>
                                                                          

                                                                          
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;4: </span><span  
class="content">A ri&#xFB04;e shu&#xFB04;e on a <!--l. 873--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mn>0</mn></math>-card
deck cut into a top packet of <!--l. 873--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>4</mn></math>
cards and bottom packet of <!--l. 873--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>6</mn></math>
cards.</span></div><!--tex4ht:label?: x1-80014 -->
                                                                          

                                                                          
   </div><hr class="endfigure" />
<!--l. 877--><p class="indent" >   A special case of this is the <span 
class="cmbx-12">perfect shu&#xFB04;e</span>, also known as the <span 
class="cmbx-12">faro shu&#xFB04;e</span>
wherein the two packets are completely interleaved, one card from each hand
following one card from the other hand. A perfect shu&#xFB04;e is easy to describe but
di&#xFB03;cult to perform, except for practiced magicians.
</p><!--l. 885--><p class="indent" >   Choose among all possible interleavings uniformly with
<!--l. 885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math> locations
among <!--l. 886--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
places for the &#xFB01;rst packet, &#xFB01;xing the locations for the cards of the other packet.
This is the well-known &#x201C;stars and bars&#x201D; counting argument, with the &#xFB01;rst packet
playing the role of the &#x201C;stars&#x201D;, the second packet the &#x201C;bars&#x201D; creating
<!--l. 889--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>n</mi></mrow>
<mrow><mi 
>k</mi></mrow></mfrac></mfenced> </mrow></math> possible
interleavings. With uniform choice, this means the probability of any one interleaving has
probability <!--l. 891--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-bin">&#x2215;</mo><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>n</mi></mrow>
<mrow><mi 
>k</mi></mrow></mfrac></mfenced> </mrow></math>
of occurring. Hence the probability of any particular cut, followed by any particular
interleaving is <!--l. 893--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mi 
>n</mi></mrow> 
<mrow><mi 
>k</mi></mrow></mfrac></mfenced> <mo 
class="MathClass-bin">&#x22C5;</mo> <mn>1</mn><mo 
class="MathClass-bin">&#x2215;</mo><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>n</mi></mrow>
<mrow><mi 
>k</mi></mrow></mfrac></mfenced> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math>.
Note that this probability has no information about the cut or the interleaving.
The density on possible cuts and interleaving is uniform,.
</p><!--l. 898--><p class="indent" >   The uniform density on the set of cuts and interleavings now induces in a natural
way a density on the set of permutations. Call the density a <span 
class="cmti-12">ri&#xFB04;e shu&#xFB04;e </span>and denote it
by <!--l. 900--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi></mrow></math>. That is,
<!--l. 900--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>&#x03C0;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math> is the sum
of probabilities of each cut and interleaving that gives the rearrangement of the deck
corresponding to <!--l. 902--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>.
In short, the chance of any arrangement of cards occurring under ri&#xFB04;e shu&#xFB04;ing is
the proportion of cuts and interleavings that give that arrangement.
</p>
   <div class="newtheorem">
<!--l. 906--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Example.</span>  </span>Consider the ri&#xFB04;e shu&#xFB04;e on a <!--l. 907--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>-card
deck as a Markov chain. The probability distribution for <!--l. 908--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi></mrow></math>
is in Table&#x00A0;<a 
href="#x1-80021">1<!--tex4ht:ref: tab:cardshuffling:riffle3 --></a>. To obtain the entries in the transition probability matrix,
systematically go through the possible cuts and interleavings. Cutting three
cards into the left packet, and none in the right packet, the only possible
interleaving trivially leaves the deck unchanged. With a cut into <!--l. 913--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
cards on the left, <!--l. 914--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
                                                                          

                                                                          
card on the right, one interleaving drops the right packet card on the bottom,
the left packet cards as the top <!--l. 915--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>,
leaving the deck unchanged. Two other interleavings move the card in the
right packet to the middle or the top. The other two cuts are symmetric to the
cuts described above, so <!--l. 918--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>
of the <!--l. 918--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>8</mn></mrow></math>
cuts and interleavings keep the deck in the original order. However, one shu&#xFB04;e
each moves the formerly bottom card labeled <!--l. 920--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
to the middle or top position, leaving cards <!--l. 921--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
and <!--l. 921--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
in that order in the shu&#xFB04;ed deck. A single ri&#xFB04;e shu&#xFB04;e cannot reverse the
order of the deck.
</p>
   <div class="table">
<!--l. 926--><p class="indent" >   <a 
 id="x1-80021"></a></p><hr class="float" /><div class="float" 
>
   <div class="caption" 
><span class="id">Table&#x00A0;1:    </span><span  
class="content">Probability    distribution    for    a    ri&#xFB04;e    shu&#xFB04;e    on    a
<!--l. 928--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>
card deck.</span></div><!--tex4ht:label?: x1-80021 -->
<div class="tabular"> <table id="TBL-4" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1" /><col 
id="TBL-4-2" /><col 
id="TBL-4-3" /><col 
id="TBL-4-4" /><col 
id="TBL-4-5" /><col 
id="TBL-4-6" /><col 
id="TBL-4-7" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-1"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>&#x03C0;</mi></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-2"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-3"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-4"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>3</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-5"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>3</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-6"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-7"  
class="td11"><!--l. 930--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>2</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-1"  
class="td11"><!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>&#x03C0;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></math> </td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-2"  
class="td11"><!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-3"  
class="td11"><!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-4"  
class="td11"><!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-5"  
class="td11"><!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-6"  
class="td11"><!--l. 931--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></math></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-7"  
class="td11">                               0.                                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="text-align:center; white-space:nowrap;" id="TBL-4-3-1"  
class="td11">                                                                </td></tr></table>
</div> </div><hr class="endfloat" />
   </div>
<!--l. 936--><p class="indent" >   To obtain the entries in Table&#x00A0;<a 
href="#x1-80021">1<!--tex4ht:ref: tab:cardshuffling:riffle3 --></a> do the computation for
a typical element of the transition probability matrix, say
<!--l. 938--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>&#x03C0;</mi><mo 
class="MathClass-punc">,</mo><mi 
>&#x03C3;</mi></mrow></msub 
></mrow></math> with
<!--l. 939--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math> and
<!--l. 939--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>3</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>.
Then <!--l. 939--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
and <!--l. 940--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>3</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>.
Now <!--l. 940--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>3</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>8</mn></mrow></mfrac></mrow></math>,
giving <!--l. 941--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>3</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>8</mn></mrow></mfrac></mrow></math> in
the probability transition matrix.
</p><!--l. 944--><p class="indent" >   The full probability transition matrix under this ordering of the permutations
is
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 946--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mspace width="3.26288pt" class="tmspace"/><mfenced separators="" 
open="("  close=")" ><mrow>   
<img 
src="cardshuffling1x.png" alt="       &#x005B;123 &#x005D;  &#x005B;213 &#x005D;  &#x005B;231&#x005D;  &#x005B;132&#x005D;  &#x005B;312&#x005D;  &#x005B;321&#x005D;
&#x005B;123 &#x005D;    1      1     1      1      1      0
         21      81     81      81      8      1
&#x005B;213 &#x005D;    81      21     81      8      01      81
&#x005B;231 &#x005D;    8      8     2      0      8      8
&#x005B;132 &#x005D;    18      18     0      12      18      18
&#x005B;312 &#x005D;    1     0      1      1      1      1
&#x005B;321 &#x005D;    80      1     81      81      21      81
                8     8      8      8      2   "  class="pic-halign"  />                                            <mspace width="0.3em" class="thinspace"/></mrow></mfenced><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 962--><p class="nopar" > Although in this case, the <!--l. 962--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">=</mo> <mn>3</mn></mrow></math>
ri&#xFB04;e shu&#xFB04;e, the matrix is symmetric, this is in general not true, the ri&#xFB04;e shu&#xFB04;e with deck
sizes greater than <!--l. 964--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
is nonsymmetric, see the exercises.
</p>
   </div>
<!--l. 967--><p class="indent" >   First note that the Markov chain for ri&#xFB04;e shu&#xFB04;ing is regular, that is, any
permutation has a positive probability of appearing after su&#xFB03;ciently many
shu&#xFB04;es, see the exercises. In fact, any number of shu&#xFB04;es greater than
<!--l. 970--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--> </mrow><mrow 
><mn>2</mn></mrow></msub 
><mi 
>n</mi></mrow></math>
will do. Since the ri&#xFB04;e shu&#xFB04;e Markov chain is regular, there is
a unique stationary density, which is the uniform density on
<!--l. 972--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>.
</p><!--l. 974--><p class="indent" >   Starting with the identity ordering, the density of the permutations after
<!--l. 975--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math> ri&#xFB04;e shu&#xFB04;es is
the &#xFB01;rst row of <!--l. 975--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>7</mn></mrow></msup 
></mrow></math>.
With matrix multiplication, the density is nearly uniform. In fact,
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 977--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><msup><mrow 
>
<mi 
>P</mi></mrow><mrow 
><mn>7</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo>  <mfenced separators="" 
open="("  close=")" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>7</mn><mn>0</mn><mn>5</mn><mn>9</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>2</mn><mn>7</mn><mn>8</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>7</mn><mn>0</mn><mn>5</mn><mn>9</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>2</mn><mn>7</mn><mn>8</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>7</mn><mn>0</mn><mn>5</mn><mn>9</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>2</mn><mn>7</mn><mn>8</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>2</mn><mn>7</mn><mn>8</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>7</mn><mn>0</mn><mn>5</mn><mn>9</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>2</mn><mn>7</mn><mn>8</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>7</mn><mn>0</mn><mn>5</mn><mn>9</mn></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>2</mn><mn>7</mn><mn>8</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>6</mn><mn>6</mn><mn>6</mn><mn>6</mn></mtd> <mtd 
class="array"  columnalign="center"><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mn>7</mn><mn>0</mn><mn>5</mn><mn>9</mn></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd></mtr> <!--*\c@MaxMatrixCols c--></mtable>                                     </mrow></mfenced> <mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 994--><p class="nopar" > That is, <!--l. 994--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
shu&#xFB04;es of the 3-card deck gets close to the stationary density, which turns out to
be the uniform density.
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-9000"></a>Probability of a Permutation Under Ri&#xFB04;e Shu&#xFB04;e</h4>
<!--l. 999--><p class="noindent" >De&#xFB01;ne a <span 
class="cmbx-12">rising sequence </span>of a permutation as a maximal increasing
subsequence within the permutation, potentially with gaps in
position. In more detail applied to shu&#xFB04;ed decks of cards, say
<!--l. 1003--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math>
is a particular card from the deck. After the position of
<!--l. 1004--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math> look for the
card labeled <!--l. 1004--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>.
If found, repeat the procedure and looking after the
<!--l. 1005--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math> card for
the <!--l. 1006--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn></mrow></math>
card. Keep going in this manner until it is not possible to
&#xFB01;nd the next card adjacent. Now go back to the original card
<!--l. 1007--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math> and look
for the <!--l. 1008--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math>
card immediately prior and so on. When done, the subsequence of the permutation
containing <!--l. 1009--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math>
is a rising sequence. A little thought shows that a deck breaks down as a disjoint
                                                                          

                                                                          
union of its rising sequences, since the union of any two consecutively increasing
subsequences with that element is a rising subsequence.
</p>
   <div class="newtheorem">
<!--l. 1014--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Example.</span>  </span>Suppose that a permutation of a deck is <!--l. 1015--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn><mn>5</mn><mn>1</mn><mn>6</mn><mn>2</mn><mn>3</mn><mn>7</mn><mn>8</mn></mrow></math>.
Start with any card, say <!--l. 1016--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>.
Look for <!--l. 1016--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>
and do not &#xFB01;nd it. Look before the <!--l. 1017--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
and &#xFB01;nd <!--l. 1017--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
and before it, with a gap, &#xFB01;nd <!--l. 1017--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>.
So one of the rising sequences of this permutation is <!--l. 1018--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mn>2</mn><mn>3</mn></mrow></math>.
Now start again, this time with say <!--l. 1019--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>6</mn></mrow></math>.
After a gap, &#xFB01;nd <!--l. 1019--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
and then after it <!--l. 1020--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>8</mn></mrow></math>.
Before <!--l. 1020--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>6</mn></mrow></math>
with a gap &#xFB01;nd <!--l. 1020--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>5</mn></mrow></math>
and then <!--l. 1021--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>.
So another rising sequence is <!--l. 1021--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn><mn>5</mn><mn>6</mn><mn>7</mn><mn>8</mn></mrow></math>.
This accounts for all cards and the deck has only two rising sequences. Writing
the sequence as <!--l. 1023--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn><msub><mrow 
><mn>5</mn></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mn>6</mn></mrow><mrow 
><mn>2</mn><mn>3</mn></mrow></msub 
><mn>7</mn><mn>8</mn></mrow></math>,
o&#xFB00;setting the two subsequences, makes this clear.
</p>
   </div>
   <div class="newtheorem">
<!--l. 1027--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Example.</span>  </span>The ri&#xFB04;e shu&#xFB04;e in Figure&#x00A0;<a 
href="#x1-80014">4<!--tex4ht:ref: fig:cardshuffling:riffle --></a> has two rising sequences, <!--l. 1029--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>2</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>3</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>4</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
and <!--l. 1030--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>5</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>6</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>7</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>8</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>9</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>&#x03C0;</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn><mn>0</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>.
</p>
   </div>
   <div class="newtheorem">
<!--l. 1034--><p class="noindent" ><span class="head">
                                                                          

                                                                          
<span 
class="cmti-12">Example.</span>  </span>Note that <!--l. 1035--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn><msub><mrow 
><mn>5</mn></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mn>6</mn></mrow><mrow 
><mn>2</mn><mn>3</mn></mrow></msub 
><mn>7</mn><mn>8</mn></mrow></math>
is a possible result of a ri&#xFB04;e shu&#xFB04;e. Here the cut must divide the deck into
two packets such that the length of each is the same as the length of the
corresponding rising sequence. So if the deck started in the natural order and
the deck is cut into <!--l. 1039--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mn>2</mn><mn>3</mn></mrow></math>
on left and <!--l. 1039--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn><mn>5</mn><mn>6</mn><mn>7</mn><mn>8</mn></mrow></math>
on the right, then the shu&#xFB04;e interleaves by dropping on the bottom <!--l. 1041--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>8</mn></mrow></math>,
then <!--l. 1041--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>,
then <!--l. 1041--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>,
then <!--l. 1041--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>,
then <!--l. 1041--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>6</mn></mrow></math>,
then <!--l. 1042--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>,
then <!--l. 1042--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>5</mn></mrow></math>
and <!--l. 1042--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>,
thus obtaining the given top down order through ri&#xFB04;ing.
</p>
   </div>
<!--l. 1046--><p class="indent" >   In general, a permutation <!--l. 1046--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
of <!--l. 1046--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
cards in original order made by a ri&#xFB04;e shu&#xFB04;e will have exactly
<!--l. 1047--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
rising sequences &#x0028;unless it is the identity with exactly
<!--l. 1048--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
rising sequence&#x0029;. This is a consequence of the de&#xFB01;nition of a ri&#xFB04;e
shu&#xFB04;e as a cut and an interleaving. Conversely any permutation of
<!--l. 1050--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math> cards
with <!--l. 1050--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> or
<!--l. 1051--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math> rising
sequences can be obtained by a physical shu&#xFB04;e. The lengths of the rising sequences
de&#xFB01;ne the size of the cuts, the gaps in a subsequence de&#xFB01;ne the interleavings.
Therefore a mathematical de&#xFB01;nition of a ri&#xFB04;e shu&#xFB04;e can be made as &#x201C;a permutation
with <!--l. 1054--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> or
<!--l. 1055--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math> rising sequences.&#x201D;
Suppose <!--l. 1055--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi></mrow></math> cards are cut o&#xFB00;
the top. Then there are <!--l. 1056--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>n</mi></mrow>
<mrow><mi 
>c</mi></mrow></mfrac></mfenced> </mrow></math>
possible ri&#xFB04;e shu&#xFB04;es, &#x0028;one of which is the identity shu&#xFB04;e&#x0029;. As in
                                                                          

                                                                          
Figure&#x00A0;<a 
href="#x1-80014">4<!--tex4ht:ref: fig:cardshuffling:riffle --></a>, after the shu&#xFB04;e, the red and black cards form a binary
<!--l. 1059--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-tuple with
<!--l. 1059--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>c</mi></mrow></math> red cards,
there are <!--l. 1059--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>n</mi></mrow>
<mrow><mi 
>c</mi></mrow></mfrac></mfenced> </mrow></math>
such <!--l. 1060--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-tuples,
one of which is the original order. The total number of possible ri&#xFB04;e shu&#xFB04;es
is
</p>
   <div class="math-display"><!--l. 1062--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                               <mn>1</mn> <mo 
class="MathClass-bin">+</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>c</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
> <mfenced separators="" 
open="("  close=")" ><mrow><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>n</mi></mrow>
<mrow><mi 
>c</mi></mrow></mfrac></mfenced> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>n</mi><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 1064--><p class="nopar" >
</p><!--l. 1066--><p class="indent" >   The next goal is to get similar results about what happens
after multiple ri&#xFB04;e shu&#xFB04;es. This can be done by considering
<!--l. 1067--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;es. A
<!--l. 1068--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math><span 
class="cmbx-12">-shu&#xFB04;e </span>is another
probability density on <!--l. 1068--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>. Let
<!--l. 1069--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math> be any positive integer.
Cut the deck into <!--l. 1069--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math> packets
of nonnegative sizes <!--l. 1070--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></math>
with <!--l. 1070--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">&#x22EF;</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi></mrow></math> but
some of the <!--l. 1071--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow></math>
may be zero. The probability of this particular packet structure is given by the
multinomial density:
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 1073--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                        <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow>          <mi 
>n</mi></mrow> 
<mrow><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></mfrac></mfenced><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 1075--><p class="nopar" > Interleave the cards from each packet in any way, so long as the cards
from each packet keep the relative order among themselves. With a &#xFB01;xed
packet structure, consider all interleavings equally likely. Count the
number of such interleavings as the number of ways of choosing among
<!--l. 1079--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math> positions in the deck,
<!--l. 1079--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math> places for things
of the &#xFB01;rst type, <!--l. 1080--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>
places for things of the second type and so on. The count is the multinomial
coe&#xFB03;cient
</p>
   <div class="math-display"><!--l. 1082--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow>
                                                <mi 
>n</mi></mrow> 
<mrow><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></mfrac></mfenced><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 1084--><p class="nopar" > Hence the probability of a particular rearrangement, i.e.&#x00A0;a cut of the deck and an
interleaving is
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 1086--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                          <mfenced separators="" 
open=""  close="/" ><mrow> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow>          <mi 
>n</mi></mrow> 
<mrow><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></mfrac></mfenced></mrow></mfenced><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow>          <mi 
>n</mi></mrow> 
<mrow><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></mfrac></mfenced> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 1089--><p class="nopar" > So it turns out that each combination of a particular cut into packets and an
interleaving is equally likely, just as in the ri&#xFB04;e shu&#xFB04;e. The induced density
on the permutations leading to the cuts and shu&#xFB04;es is then called the
<!--l. 1092--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e, with notation
<!--l. 1094--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></math>. The ri&#xFB04;e shu&#xFB04;e
is just the <!--l. 1094--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>-shu&#xFB04;e,
so <!--l. 1095--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>R</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>R</mi></mrow></math>.
</p><!--l. 1097--><p class="indent" >   An  equivalent  description  of  the
<!--l. 1097--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e
begins the same way, by cutting the deck into packets multinomially. Then
drop cards from the bottom of the packets, one at a time, such that the
probability of choosing a particular packet to drop is proportional to
the relative size of that packet compared to the number of all cards in
the packets. The proof of this description is exactly analogous to the
<!--l. 1102--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math>
case.
</p><!--l. 1105--><p class="indent" >   A third equivalent description is cutting the deck multinomially into packets of
size <!--l. 1106--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math> and
ri&#xFB04;ing <!--l. 1106--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>
and <!--l. 1106--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>
together, meaning choose uniformly among all interleavings that the keep
the relative order of each packet, then ri&#xFB04;ing the resulting pile with
<!--l. 1109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
></mrow></math>, then ri&#xFB04;ing that
resulting pile with <!--l. 1109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
></mrow></math>
and so on.
</p><!--l. 1112--><p class="indent" >   It turns out that when performing a single
                                                                          

                                                                          
<!--l. 1112--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e,
the probability of achieving a particular permutation
<!--l. 1113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
does not depend on the information contained in
<!--l. 1114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>,
but only on the number of rising sequences that
<!--l. 1115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math> has. In other words,
the permutations <!--l. 1116--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>5</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow><mo 
class="MathClass-punc">,</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>4</mn><mn>5</mn><mn>1</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow><mo 
class="MathClass-punc">,</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>5</mn><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>, and
<!--l. 1116--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>3</mn><mn>4</mn><mn>5</mn><mn>1</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math> have the same probability
under any <!--l. 1117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e,
since each has exactly two rising sequences.
</p><!--l. 1120--><p class="indent" >   A useful code through <!--l. 1120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-digit
base-<!--l. 1120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
numbers speci&#xFB01;es how to make a particular
<!--l. 1121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e.
Here a &#x201C;shu&#xFB04;e&#x201D; indicates a particular way of rearranging the
deck, not the probability density on all such rearrangements. Let
<!--l. 1123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math> be an
<!--l. 1123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-digit
base-<!--l. 1123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math> number. Count
the number of <!--l. 1124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>s in
<!--l. 1124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>, this will be the size
of the &#xFB01;rst packet <!--l. 1125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>
in the <!--l. 1125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e.
Then <!--l. 1125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math> is the
number of <!--l. 1126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>s in
<!--l. 1126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math> and so on up to
<!--l. 1126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
></mrow></math>, the number
of <!--l. 1127--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>s. This cuts
the deck into <!--l. 1127--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
packets. Now take the beginning packet of cards of size
<!--l. 1128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></math>. Envision placing these
cards on top of all the <!--l. 1129--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>
digits keeping their order as a rising sequence. Do the same for the next packet of size
<!--l. 1130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></math>, placing them on
the <!--l. 1131--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>s. Continue
up through the <!--l. 1131--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>s.
This particular way of rearranging the cards will then be
                                                                          

                                                                          
the particular cut and the interleaving corresponding to
<!--l. 1133--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>. Note that the number
of such encodings is <!--l. 1134--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></math>.
</p>
   <div class="newtheorem">
<!--l. 1136--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Example.</span>  </span>Let an 8-card deck start in natural order. Let <!--l. 1137--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mn>3</mn><mn>0</mn><mn>0</mn><mn>4</mn><mn>1</mn><mn>0</mn><mn>3</mn></mrow></math>
be the code for a particular <!--l. 1138--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>5</mn></mrow></math>-shu&#xFB04;e
of the <!--l. 1138--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>8</mn></mrow></math>-card
deck. The code has three <!--l. 1139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>s,
one <!--l. 1139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>,
one <!--l. 1139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>,
two <!--l. 1139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>s
and one <!--l. 1139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>.
Thus <!--l. 1140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>3</mn></mrow></math>,
<!--l. 1140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>,
<!--l. 1140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>,
<!--l. 1140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math>
and <!--l. 1141--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>5</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>.
So cut the deck into <!--l. 1141--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mn>2</mn><mn>3</mn><mo 
class="MathClass-rel">&#x007C;</mo><mn>4</mn><mo 
class="MathClass-rel">&#x007C;</mo><mn>5</mn><mo 
class="MathClass-rel">&#x007C;</mo><mn>6</mn><mn>7</mn><mo 
class="MathClass-rel">&#x007C;</mo><mn>8</mn></mrow></math>.
We put <!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mn>2</mn><mn>3</mn></mrow></math>
where the <!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>s
are in <!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>,
<!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>
where the <!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
is, <!--l. 1143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>5</mn></mrow></math>
where the <!--l. 1143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
is, <!--l. 1143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>6</mn><mn>7</mn></mrow></math>
where the <!--l. 1143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>s
are, and <!--l. 1144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>8</mn></mrow></math>
where the <!--l. 1144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>
is. Then get a shu&#xFB04;ed deck of <!--l. 1144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>5</mn><mn>6</mn><mn>1</mn><mn>2</mn><mn>8</mn><mn>4</mn><mn>3</mn><mn>7</mn></mrow></math>
after applying <!--l. 1145--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>A</mi></mrow></math>
to the natural order.
</p>
   </div>
                                                                          

                                                                          
<!--l. 1148--><p class="indent" >   This code gives a bijective correspondence between
<!--l. 1148--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-digit
base-<!--l. 1148--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
numbers and the set of all ways of cutting and interleaving an
<!--l. 1149--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-card deck according
to the <!--l. 1150--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e.
In fact, if we put the uniform density on the set of
<!--l. 1151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-digit
base-<!--l. 1151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math> numbers,
this transfers to the correct uniform probability density for cutting and interleaving in an
<!--l. 1153--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e which means the
correct density induced on <!--l. 1154--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>.
</p>
   <div class="newtheorem">
<!--l. 1156--><p class="noindent" ><span class="head">
<a 
 id="x1-9001r6"></a>
<span 
class="cmbx-12">Theorem 6.</span>  </span><span 
class="cmti-12">The probability of achieving a permutation </span><!--l. 1157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
<span 
class="cmti-12">when doing an </span><!--l. 1157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math><span 
class="cmti-12">-shu&#xFB04;e</span>
<span 
class="cmti-12">on an </span><!--l. 1158--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math><span 
class="cmti-12">-card</span>
<span 
class="cmti-12">deck is</span>
</p>
   <div class="math-display"><!--l. 1159--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                       <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow> 
    <mrow><mi 
>n</mi></mrow></mfrac></mfenced>     <mo 
class="MathClass-punc">,</mo>
</mrow></math></div>
<!--l. 1161--><p class="nopar" > <span 
class="cmti-12">where </span><!--l. 1161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math>
<span 
class="cmti-12">is the number of rising sequences in </span><!--l. 1161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math><span 
class="cmti-12">.</span>
</p>
                                                                          

                                                                          
   </div>
<!--l. 1164--><p class="indent" >
</p>
   <div class="proof">
<!--l. 1165--><p class="indent" >   <span class="head">
<span 
class="cmti-12">Proof.</span> </span>
      </p><dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
   1. </dt><dd 
class="enumerate-enumitem">Establish and &#xFB01;x where the <!--l. 1167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
      cuts occur in an <!--l. 1167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e,
      then whatever permutations can actually be achieved by interleaving
      the cards from this cut and packet structure can be achieved in exactly
      one way: Just drop the cards in exactly the order of the permutation.
      </dd><dt class="enumerate-enumitem">
   2. </dt><dd 
class="enumerate-enumitem">Thus the probability of achieving a particular permutation is the number
      of possible ways of making cuts that could actually cause that permutation,
      divided by the total number of ways of making cuts and interleaving for
      an <!--l. 1176--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e.
      </dd><dt class="enumerate-enumitem">
   3. </dt><dd 
class="enumerate-enumitem">Having <!--l. 1178--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math>
      rising sequences in <!--l. 1178--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>
      determines exactly where <!--l. 1179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>r</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
      of the cuts must have been: between pairs of consecutive cards in the
      naturally ordered deck such that the &#xFB01;rst card of the pair ends one rising
      sequence of <!--l. 1182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math>.
      </dd><dt class="enumerate-enumitem">
   4. </dt><dd 
class="enumerate-enumitem">This means that we have <!--l. 1184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-bin">&#x2212;</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>r</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow></math>
      unspeci&#xFB01;ed or free cuts that can go anywhere.
      </dd><dt class="enumerate-enumitem">
   5. </dt><dd 
class="enumerate-enumitem">So count the number of ways of putting <!--l. 1187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow></math>
      cuts among <!--l. 1187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
      cards. The standard &#x201C;stars and bars&#x201D; combinatorial argument counts
                                                                          

                                                                          
<div class="math-display"><!--l. 1190--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow>
                                 <mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow>
    <mrow><mi 
>n</mi></mrow></mfrac></mfenced>
</mrow></math></div>
      <!--l. 1192--><p class="nopar" > ways to do this, i.e.&#x00A0;choosing <!--l. 1192--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
      places among <!--l. 1192--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>a</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>.
      This is the numerator of the probability.
      </p></dd><dt class="enumerate-enumitem">
   6. </dt><dd 
class="enumerate-enumitem">The denominator is the number of possible ways to cut and interleave
      for an <!--l. 1196--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>-shu&#xFB04;e.
      The encoding of the shu&#xFB04;es as the number of <!--l. 1197--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-digit
      base <!--l. 1197--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>a</mi></mrow></math>
      numbers gives <!--l. 1198--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></math>
      ways to do this.</dd></dl>
                                                                         &#x25A1;
   </div>
   <div class="newtheorem">
<!--l. 1202--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Remark.</span>  </span>Compare the results of this theorem with the entries of the matrix
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 1204--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
<mspace width="3.26288pt" class="tmspace"/><mfenced separators="" 
open="("  close=")" ><mrow>   
<img 
src="cardshuffling2x.png" alt="       &#x005B;123 &#x005D;  &#x005B;213 &#x005D;  &#x005B;231&#x005D;  &#x005B;132&#x005D;  &#x005B;312&#x005D;  &#x005B;321&#x005D;
&#x005B;123 &#x005D;    1      1     1      1      1      0
         21      81     81      81      8      1
&#x005B;213 &#x005D;    81      21     81      8      01      81
&#x005B;231 &#x005D;    8      8     2      0      8      8
&#x005B;132 &#x005D;    18      18     0      12      18      18
&#x005B;312 &#x005D;    1     0      1      1      1      1
&#x005B;321 &#x005D;    80      1     81      81      21      81
                8     8      8      8      2   "  class="pic-halign"  />                                            <mspace width="0.3em" class="thinspace"/></mrow></mfenced><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 1220--><p class="nopar" > Application of the theorem is easier than counting the shu&#xFB04;es carrying one
permutation to another.
</p>
   </div>
<!--l. 1225--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-10000"></a>Rate of convergence to the stationary distribution</h4>
<!--l. 1227--><p class="noindent" >Recall the modeling of card shu&#xFB04;ing as a Markov chain. The initial state
<!--l. 1228--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow></math> is the
identity permutation, that is cards in the initial deck order numbered
<!--l. 1229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> to
<!--l. 1229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>, with
probability <!--l. 1229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>.
A particular ri&#xFB04;e shu&#xFB04;e, one of a whole family of ri&#xFB04;e shu&#xFB04;es, is chosen with a
probability distribution from the family. This probability distribution
then induces a transition probability from state to state. Going from card
order<!--l. 1233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math> to
<!--l. 1233--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi></mrow></math> is the same as composing
                                                                          

                                                                          
<!--l. 1234--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math> with the permutation
<!--l. 1234--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow></math>. Now identify shu&#xFB04;es
as functions on <!--l. 1235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="{"  close="}" ><mrow><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mi 
>n</mi></mrow></mfenced></mrow></math>
to <!--l. 1235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfenced separators="" 
open="{"  close="}" ><mrow><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo><mi 
>n</mi></mrow></mfenced></mrow></math>,
that is, permutations. Since a particular ri&#xFB04;e shu&#xFB04;e is one of a
whole family of ri&#xFB04;e shu&#xFB04;es, chosen with a probability distribution
<!--l. 1238--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>Q</mi></mrow></math>
from the family, the transition probabilities are
<!--l. 1238--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>&#x03C0;</mi><mi 
>&#x03C3;</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x2119;</mi> <mfenced separators="" 
open="["  close="]" ><mrow><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C3;</mi><mo 
class="MathClass-rel">&#x2223;</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>&#x03C0;</mi></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <mi 
>Q</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>.
</p><!--l. 1242--><p class="indent" >   The rate of convergence of <!--l. 1242--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>
to the stationary density, measured by the total variation distance of some other
metric, is determined by the eigenvalues of the transition matrix. We know that the
entries of <!--l. 1244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow></math>
are the probabilities of certain permutations being achieved under
<!--l. 1246--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math> ri&#xFB04;e
shu&#xFB04;es. These probabilities are of the form
</p>
   <div class="math-display"><!--l. 1247--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                          <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi><mi 
>k</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>k</mi></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow> 
     <mrow><mi 
>n</mi></mrow></mfrac></mfenced>     <mo 
class="MathClass-punc">,</mo>
</mrow></math></div>
<!--l. 1249--><p class="nopar" > for the probability of a permutation with
<!--l. 1249--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math> rising sequences
being achieved after <!--l. 1250--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>
ri&#xFB04;e shu&#xFB04;es.
</p><!--l. 1252--><p class="indent" >   Mann <span class="cite">&#x005B;<a 
href="#Xmann94">2</a>&#x005D;</span> asserts that the eigenvalues of the transition probability matrix for a single ri&#xFB04;e
shu&#xFB04;e are exactly <!--l. 1254--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math>,
see the exercises. The second largest eigenvalue determines the rate of
convergence to the stationary distribution. For ri&#xFB04;e shu&#xFB04;ing, this eigenvalue is
<!--l. 1257--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mrow></math>. Once
                                                                          

                                                                          
the variation distance gets to the cuto&#xFB00;, it decreases by a factor of approximately
<!--l. 1259--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mrow></math> with
each shu&#xFB04;e.
</p>
   <div class="newtheorem">
<!--l. 1261--><p class="noindent" ><span class="head">
<span 
class="cmti-12">Example.</span>  </span>The ri&#xFB04;e shu&#xFB04;e matrix for the deck of three cards is
</p>
   <div class="math-display"><!--l. 1263--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
 <mfenced separators="" 
open="("  close=")" ><mrow><mtable  align="axis" style=""  
equalrows="false" columnlines="none none none none none none none none none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd>
</mtr> <mtr><mtd 
class="array"  columnalign="center"><mn>0</mn></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>8</mn></mrow></mfrac></mtd><mtd 
class="array"  columnalign="center"><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mtd></mtr> <mtr><mtd 
class="array"  columnalign="center"> </mtd></mtr> <!--*\c@MaxMatrixCols c--></mtable>                                                                                                                       </mrow></mfenced> <mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 1279--><p class="nopar" > The eigenvalues of this matrix are <!--l. 1279--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac></mrow></math>.
</p>
   </div>
<!--l. 1283--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/question_mark.png" alt="Section Starter Question"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-11000"></a>Section Ending Answer</h3>
<!--l. 1286--><p class="noindent" >For card players, shu&#xFB04;ing the deck to remove any order is essential so that cards
dealt from the deck come &#x201C;at random&#x201D;, that is, in an order uniformly
distributed over all possible deck orders. For the Top-to-Random-Shu&#xFB04;e
<!--l. 1289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
                                                                          

                                                                          
shu&#xFB04;es of the 3-card deck gets close to the uniform density, which turns out
to be the stationary density. With a ri&#xFB04;e shu&#xFB04;e on a standard deck,
<!--l. 1291--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>7</mn></mrow></math>
shu&#xFB04;es gets close to the uniform density.
</p><!--l. 1294--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-12000"></a>Sources</h4>
<!--l. 1294--><p class="noindent" >This section is adapted from <span class="cite">&#x005B;<a 
href="#Xmann94">2</a>&#x005D;</span>. Parts are also adapted from <span class="cite">&#x005B;<a 
href="#Xaldous86">1</a>&#x005D;</span>.
</p><!--l. 1298--><p class="indent" >   _______________________________________________________________________________________________
</p><!--l. 1300--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/computer.png" alt="Algorithms, Scripts, Simulations"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-13000"></a>Algorithms, Scripts, Simulations</h3>
<!--l. 1303--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-14000"></a>Algorithm</h4>
<!--l. 1305--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-15000"></a>Scripts</h4>
<!--l. 1309--><p class="noindent" >__________________________________________________________________________
</p><!--l. 1311--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/solveproblems.png" alt="Problems to Work"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-16000"></a>Problems to Work for Understanding</h3>
                                                                          

                                                                          
<a 
 id="x1-16001r1"></a>
   1: Show that the Markov chain <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>
on <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>
induced by the TTRS is irreducible.
<a 
 id="x1-16026r2"></a>
   2: Show that the Markov chain <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow></math>
on <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>
induced by the ri&#xFB04;e shu&#xFB04;e is irreducible.
<a 
 id="x1-16037r3"></a>
   3:  Show that for all <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>m</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi></mrow></math>
   <div class="math-display"><!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><msup><mrow 
>
                                <mfenced separators="" 
open="("  close=")" ><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac></mrow></mfenced></mrow><mrow 
><mi 
>m</mi></mrow></msup 
> <mo 
class="MathClass-rel">&#x2264;</mo> <mi 
>n</mi><msup><mrow 
><mi mathvariant="normal">e</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>m</mi><mo 
class="MathClass-bin">&#x2215;</mo><mi 
>n</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 5--><p class="nopar" >
<a 
 id="x1-16049r4"></a>
   4:   Show with a speci&#xFB01;c pair of permutations on
<!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math> cards
that the transition probability matrix is not symmetric.
<a 
 id="x1-16085r5"></a>
   5: Using a speci&#xFB01;c example with <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow></math>
and <!--l. 2--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math>
explicitly write out
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow>
                                <mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow> 
    <mrow><mi 
>n</mi></mrow></mfrac></mfenced>     <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msub><mrow 
><mi 
>c</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>r</mi><mo 
class="MathClass-punc">,</mo><mi 
>i</mi></mrow></msub 
><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msup 
>
</mrow></math></div>
<!--l. 6--><p class="nopar" > giving the binomial coe&#xFB03;cient as an
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>th degree
polynomial in <!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math>
written in increasing powers with coe&#xFB03;cients as a function of
<!--l. 8--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math> and
<!--l. 8--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math>.
<a 
 id="x1-16101r6"></a>
   6:  Show that the entries in the transition probability matrix for the single ri&#xFB04;e shu&#xFB04;e on
a deck of <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math> cards
are either <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow>
 <mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac> </mrow></math>,
<!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math> or
<!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>.
<a 
 id="x1-16116r7"></a>
   7:  Show that the eigenvalues of the transition probability matrix for a single ri&#xFB04;e shu&#xFB04;e
are exactly <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math>.
</p><!--l. 1486--><p class="noindent" >__________________________________________________________________________
</p><!--l. 1488--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/books.png" alt="Books"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-17000"></a>Reading Suggestion:</h3>
<!--l. 1--><p class="noindent" >
                                                                          

                                                                          
</p>
   <h3 class="likesectionHead"><a 
 id="x1-18000"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 &#x005B;1&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xaldous86"></a>David Aldous and Persi Diaconis. Shu&#xFB04;ing cards and stopping times.
   <span 
class="cmti-12">The American Mathematical Monthly</span>, 93&#x0028;5&#x0029;:333&#x2013;348, 1986.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;2&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmann94"></a>Brad Mann.  How many times should you shu&#xFB04;e a deck of cards.
   <span 
class="cmti-12">UMAP Journal</span>, 15&#x0028;4&#x0029;:303&#x2013;332, Winter 1994.
</p>
   </div>
<!--l. 1499--><p class="noindent" >__________________________________________________________________________
</p><!--l. 1501--><p class="indent" >   <img 
src="../../../../CommonInformation/Lessons/chainlink.png" alt="Links"  
 />
</p>
   <h3 class="likesectionHead"><a 
 id="x1-19000"></a>Outside Readings and Links:</h3>
<!--l. 1504--><p class="noindent" >
      </p><dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
   1. </dt><dd 
class="enumerate-enumitem">
      </dd><dt class="enumerate-enumitem">
   2. </dt><dd 
class="enumerate-enumitem">
      </dd><dt class="enumerate-enumitem">
   3. </dt><dd 
class="enumerate-enumitem">
      </dd><dt class="enumerate-enumitem">
   4. </dt><dd 
class="enumerate-enumitem"></dd></dl>
                                                                          

                                                                          
<!--l. 1510--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-20000"></a>Solutions</h3>
<!--l. 1--><p class="noindent" >1:  The TTRS taking the top card to the bottom of the deck, moving all other cards up one
position is an <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>-cycle
on <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math>.
The TTRS taking the top card to the second place in the deck,
moving the second card to the top is an <span 
class="cmti-12">adjacent transposition </span>of
<!--l. 5--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> and
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
in that cycle. These two elements are generators of
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow></math> &#x0028;see
Michael Artin <span 
class="cmti-12">Algebra</span>, 1991, Exercise 6.6.16&#x0029; meaning that any permutation can
be achieved by a combination of these actions.
</p><!--l. 11--><p class="indent" >   More concretely, <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>
applications of the TTRS taking the top card to the bottom of the deck will move
<!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math> to the top,
<!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>, next and so
on to n, then <!--l. 13--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
to <!--l. 13--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math> in
the bottom portion of the deck. Then The TTRS taking the top card to the
second place in the deck, moving the second card to the top will exchange
<!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math> and
<!--l. 16--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>. Then
<!--l. 16--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>k</mi></mrow></math> more
applications of the TTRS taking the top card to the bottom of the deck will move the
portion <!--l. 17--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> to
<!--l. 18--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math> back to the
top, leaving <!--l. 18--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>
and <!--l. 18--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math> transposed
and then <!--l. 19--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn></mrow></math>
to <!--l. 19--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
on the bottom. Thus any adjacent transposition or
<!--l. 20--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>-cycle can
be achieved. It is a well known fact that any permutation can be written as a product
of <!--l. 21--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>-cycles,
these shu&#xFB04;es are enough to reach any permutation, meaning that the Markov
chain is irreducible.
                                                                          

                                                                          
</p><!--l. 25--><p class="noindent" >2:   By splitting the deck into one card on the left, and
<!--l. 26--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math> cards on
the right, the speci&#xFB01;c shu&#xFB04;e taking the top card to the bottom of the deck, moving
all other cards up one position is possible. By splitting the deck into one card on the
left, and <!--l. 29--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math>
cards on the right, the speci&#xFB01;c shu&#xFB04;e taking the top card to the second place in
the deck, moving the second card to the top is also possible. Then by the
previous exercises all permutations are possible and the Markov chain is
irreducible.
</p><!--l. 35--><p class="noindent" >3:  The inequality is equivalent to showing
</p>
   <div class="math-display"><!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                   <mi 
>m</mi><mo class="qopname"> log</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2264;</mo><mfrac><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>m</mi></mrow> 
  <mrow 
><mi 
>n</mi></mrow></mfrac>  <mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 39--><p class="nopar" > Since the logarithm function is concave down at
<!--l. 40--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>, then
<!--l. 41--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mo class="qopname">log</mo><!--nolimits--><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mn>1</mn> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow> <mo 
class="MathClass-rel">&#x2265;</mo><mfrac><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow> 
 <mrow 
><mi 
>n</mi></mrow></mfrac> </mrow></math>. and
the desired inequality follows immediately.
</p><!--l. 44--><p class="noindent" >4:   Starting with the deck in the order
<!--l. 45--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>, a <span 
class="cmti-12">perfect in-shu&#xFB04;e</span>
results in the order <!--l. 46--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>4</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>,
and this is the only ri&#xFB04;e shu&#xFB04;e that results in this order, so
<!--l. 47--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>4</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></msub 
> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mn>6</mn></mrow></mfrac></mrow></math>. On the other hand,
no ri&#xFB04;e shu&#xFB04;e takes <!--l. 48--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>4</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
to <!--l. 49--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
because </p>
      <ul class="itemize1">
      <li class="itemize">splitting the deck into <!--l. 52--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
      card on the left and <!--l. 52--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
                                                                          

                                                                          
      cards on the right all interleavings leave <!--l. 53--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>
      above <!--l. 53--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>,
      </li>
      <li class="itemize">splitting the deck into <!--l. 56--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
      cards on the left and <!--l. 56--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
      cards on the right all interleavings leave <!--l. 57--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
      above <!--l. 57--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>,
      and
      </li>
      <li class="itemize">splitting the deck into <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
      cards on the left and <!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>
      card on the right, all interleavings leave <!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>3</mn></mrow></math>
      above <!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>.</li></ul>
<!--l. 64--><p class="noindent" >Therefore, <!--l. 64--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>4</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></mrow></math>
and the transition probability matrix is not symmetric.
</p><!--l. 67--><p class="indent" >   Alternatively, setting <!--l. 67--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>4</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
and <!--l. 67--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>,
then <!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>3</mn><mn>1</mn><mn>4</mn><mn>2</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>R</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow></math>
where <!--l. 69--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>R</mi></mrow></math>
is the probability distribution on ri&#xFB04;e shu&#xFB04;es. Note that
<!--l. 70--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>4</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math> and
<!--l. 70--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >id</mtext></mstyle></mrow></math> so
<!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi> <mo 
class="MathClass-bin">&#x2218;</mo> <mi 
>&#x03C3;</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>4</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>. Note
that <!--l. 72--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mrow ><mo 
class="MathClass-open">&#x005B;</mo><mrow><mn>2</mn><mn>4</mn><mn>1</mn><mn>3</mn></mrow><mo 
class="MathClass-close">&#x005D;</mo></mrow></mrow></math>
has <!--l. 72--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-rel">=</mo> <mn>4</mn></mrow></math>
rising sequences. Then by the probability of achieving a permutation
<!--l. 73--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>&#x03C0;</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></mrow></math> when doing
an <!--l. 73--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>-shu&#xFB04;e
on an <!--l. 74--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>4</mn></mrow></math>-card
deck is
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 75--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                        <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>4</mn></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mn>4</mn> <mo 
class="MathClass-bin">+</mo> <mn>2</mn> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>4</mn></mrow> 
     <mrow><mn>4</mn></mrow></mfrac></mfenced>      <mo 
class="MathClass-rel">=</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 77--><p class="nopar" >
</p><!--l. 79--><p class="noindent" >5:  The point is to expand
<!--tex4ht:inline--></p><!--l. 81--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" >
<mtable 
class="multline-star">
<mtr><mtd 
class="multline-star"><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>5</mn> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>2</mn></mrow>
     <mrow><mn>5</mn></mrow></mfrac></mfenced>     <mo 
class="MathClass-rel">=</mo><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>3</mn></mrow> 
   <mrow><mn>5</mn></mrow></mfrac></mfenced>    <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>3</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow><mi 
>x</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>x</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow> 
                  <mrow 
><mn>5</mn><mo 
class="MathClass-punc">!</mo></mrow></mfrac>
</mtd></mtr><mtr><mtd 
class="multline-star"> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>5</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>5</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>4</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>5</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>3</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>5</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>6</mn><mi 
>x</mi></mrow> 
              <mrow 
><mn>5</mn><mo 
class="MathClass-punc">!</mo></mrow></mfrac>
</mtd></mtr><mtr><mtd 
class="multline-star"> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">&#x2212;</mo><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn><mn>0</mn></mrow></mfrac><mi 
>x</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn><mn>4</mn></mrow></mfrac><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">&#x2212;</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn><mn>4</mn></mrow></mfrac><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn><mn>4</mn></mrow></mfrac><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>4</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mn>2</mn><mn>0</mn></mrow></mfrac><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>5</mn></mrow></msup 
>                                  </mtd></mtr></mtable>
</math>
<!--l. 87--><p class="nopar" >
</p><!--l. 89--><p class="noindent" >6:  The transition probabilities are of the form
                                                                          

                                                                          
</p>
   <div class="math-display"><!--l. 91--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                                          <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac><mfenced separators="" 
open="(" close=")"><mfrac linethickness="0.0pt"><mrow> <mn>2</mn> <mo 
class="MathClass-bin">+</mo> <mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mi 
>r</mi></mrow> 
    <mrow><mi 
>n</mi></mrow></mfrac></mfenced>     <mo 
class="MathClass-punc">,</mo>
</mrow></math></div>
<!--l. 93--><p class="nopar" > for the probability of a permutation with
<!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi></mrow></math> rising
sequences being achieved after a single ri&#xFB04;e shu&#xFB04;es. Recall that a permutation
<!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03C0;</mi></mrow></math> of
<!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi></mrow></math>
cards in original order made by a ri&#xFB04;e shu&#xFB04;e will have exactly
<!--l. 96--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>2</mn></mrow></math>
rising sequences unless it is the identity which has exactly
<!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> rising sequence. If
<!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></mrow></math>, then the binomial
coe&#xFB03;cient will be <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></math>,
if <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow></math> then the binomial
coe&#xFB03;cient is <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math> and
if <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>r</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>2</mn></mrow></math> the binomial
coe&#xFB03;cient is <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>0</mn></mrow></math>
by convention.
</p><!--l. 102--><p class="noindent" >7:  Not a complete solution.
</p><!--l. 105--><p class="indent" >   It doesn&#x2019;t really matter what the coe&#xFB03;cients are, only that we
can write the binomial coe&#xFB03;cient expansion as a polynomial in
<!--l. 106--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math>.
Substituting <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow></math>
for <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>x</mi></mrow></math>, the
entries of <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow></math>
have the form
</p>
                                                                          

                                                                          
   <div class="math-display"><!--l. 109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                        <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi><mi 
>k</mi></mrow></msup 
></mrow></mfrac><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msub><mrow 
><mi 
>c</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>r</mi><mo 
class="MathClass-punc">,</mo><mi 
>i</mi></mrow></msub 
><msup><mrow 
> <mfenced separators="" 
open="("  close=")" ><mrow><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow></mfenced> </mrow><mrow 
><mi 
>i</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo mathsize="big" 
> &#x2211;</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msub><mrow 
><mi 
>c</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>r</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>i</mi></mrow></msub 
><msup><mrow 
> <mfenced separators="" 
open="("  close=")" ><mrow> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>i</mi></mrow></msup 
></mrow></mfrac></mrow></mfenced> </mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</mrow></math></div>
<!--l. 112--><p class="nopar" > This means that the entries of the <!--l. 112--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>th
power of <!--l. 112--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>P</mi></mrow></math>
are given by &#xFB01;xed linear combinations of the
<!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>k</mi></mrow></math>th powers
of <!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn></mrow></math>,
<!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>2</mn></mrow></mfrac></mrow></math>,
<!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mn>4</mn></mrow></mfrac></mrow></math> and
<!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math>.
Then from standard facts of linear algebra the set of all eigenvalues of
<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>P</mi></mrow></math> &#x0028;What are these standard
facts?&#x0029; is exactly <!--l. 116--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>4</mn></mrow></mfrac><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">&#x2026;</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></math>.
Further, Mann <span class="cite">&#x005B;<span 
class="cmbx-12">?</span>, mann96&#x005D;</span>sserts that the multiplicities are the Stirling numbers
of the &#xFB01;rst kind, up to sign:
</p>
   <div class="math-display"><!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                            <mo class="qopname">multiplifcity</mo><!--nolimits--> <mfenced separators="" 
open="("  close=")" ><mrow> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></mrow></mfrac></mrow></mfenced> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mi 
>i</mi></mrow></msup 
><mi 
>c</mi><mrow ><mo 
class="MathClass-open">&#x0028;</mo><mrow><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow><mo 
class="MathClass-close">&#x0029;</mo></mrow>
</mrow></math></div>
                                                                          

                                                                          
<!--l. 123--><p class="nopar" > referencing Graham, Knuth, Patashnik, <span 
class="cmti-12">Concrete Mathematics</span>, 1989, p.
243-253.
</p><!--l. 1512--><p class="noindent" >__________________________________________________________________________
</p><!--l. 3--><p class="indent" >   <span 
class="cmr-10x-x-109">I check all the information on each page for correctness and typographical errors.</span>
<span 
class="cmr-10x-x-109">Nevertheless, some errors may occur and I would be grateful if you would alert me to</span>
<span 
class="cmr-10x-x-109">such errors. I make every reasonable e&#xFB00;ort to present current and accurate information</span>
<span 
class="cmr-10x-x-109">for public use, however I do not guarantee the accuracy or timeliness of information on</span>
<span 
class="cmr-10x-x-109">this website. Your use of the information from this website is strictly voluntary and at</span>
<span 
class="cmr-10x-x-109">your risk.</span>
</p><!--l. 12--><p class="indent" >   <span 
class="cmr-10x-x-109">I have checked the links to external sites for usefulness. Links to external websites</span>
<span 
class="cmr-10x-x-109">are provided as a convenience. I do not endorse, control, monitor, or guarantee the</span>
<span 
class="cmr-10x-x-109">information contained in any external website. I don&#x2019;t guarantee that the links are</span>
<span 
class="cmr-10x-x-109">active at all times. Use the links here with the same caution as you would all</span>
<span 
class="cmr-10x-x-109">information on the Internet. This website re&#xFB02;ects the thoughts, interests and opinions of</span>
<span 
class="cmr-10x-x-109">its author. They do not explicitly represent o&#xFB03;cial positions or policies of my</span>
<span 
class="cmr-10x-x-109">employer.</span>
</p><!--l. 22--><p class="indent" >   <span 
class="cmr-10x-x-109">Information on this website is subject to change without notice.</span>
</p><!--l. 2--><p class="indent" >   Steve Dunbar&#x2019;s Home Page, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">http://www.math.unl.edu/~sdunbar1</span></span></span>
</p><!--l. 4--><p class="indent" >   Email to Steve Dunbar, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">sdunbar1</span><span 
class="cmtt-12">&#x00A0;at</span><span 
class="cmtt-12">&#x00A0;unl</span><span 
class="cmtt-12">&#x00A0;dot</span><span 
class="cmtt-12">&#x00A0;edu</span></span></span>
</p><!--l. 1516--><p class="indent" >   Last modi&#xFB01;ed: Processed from <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>&#x00A0;source on October 13, 2020
</p>
    
</body> 
</html>
                                                                          


